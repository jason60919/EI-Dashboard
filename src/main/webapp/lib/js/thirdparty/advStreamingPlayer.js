(function(){var g={};
(function(window){var k,aa=this;function p(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.dc=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.cc=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
var ba={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function ca(a){this.b=a;this.a=new da(a);ea||(ea=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var ea;
function r(a){var b;b=fa(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=fa(a);a:{for(d=0;d<ea.length;d++)if(ga(c,ea[d])){d=!0;break a}d=!1}if(d)c=a.b.byteLength-a.a.a;else{if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d}c=a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a;d=new DataView(a.b.buffer,
a.b.byteOffset+a.a.a,c);w(a.a,c);return new ha(b,d)}function fa(a){var b=ia(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=ia(a.a);return d}function ha(a,b){this.id=a;this.a=b}
function ja(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&a.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b};function x(a,b){return b.bind(a)};function y(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=y.prototype.destroy;return c}y.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function ka(){return Date.now()+la}var la=0;function ma(a){return a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function na(a){return String.fromCharCode.apply(null,a)}p("shaka.util.Uint8ArrayUtils.toString",na);function oa(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}p("shaka.util.Uint8ArrayUtils.fromString",oa);p("shaka.util.Uint8ArrayUtils.toBase64",function(a,b){var c=void 0==b?!0:b,d=window.btoa(na(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")});function pa(a){return oa(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
p("shaka.util.Uint8ArrayUtils.fromBase64",pa);p("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function qa(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}p("shaka.util.Uint8ArrayUtils.toHex",qa);function ga(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function ra(a,b){for(var c=[],d=0;d<a.length;++d){for(var e=!1,f=0;f<c.length&&!(e=b?b(a[d],c[f]):a[d]===c[f]);++f);e||c.push(a[d])}return c};function z(){this.a={}}z.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};z.prototype.set=function(a,b){this.a[a]=b};z.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function sa(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function ta(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function ua(a){var b=[],c;for(c in a.a)b.push(c);return b};function va(a){return Object.keys(a).map(function(b){return a[b]})}function xa(a,b){return ya(a,b,"boolean")}function za(a,b){var c=ya(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function Aa(a,b){return ya(a,b,"string")}
function ya(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}function Ba(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function Ca(){};function Da(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}Da.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function Ea(a){return a.b/(1-Math.pow(a.c,a.a))};function A(){this.a=new z}A.prototype.destroy=function(){Fa(this);this.a=null};function B(a,b,c,d){b=new Ga(b,c,d);a.a.push(c,b)}A.prototype.sa=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.sa(),ta(this.a,b,e))}};function Fa(a){for(var b=sa(a.a),c=0;c<b.length;++c)b[c].sa();a.a.a={}}function Ga(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
Ga.prototype.sa=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function Ha(a,b,c){Ja(b);Ja(c);return c==b||a>=Ka&&c==b.split("-")[0]||a>=La&&c.split("-")[0]==b.split("-")[0]?!0:!1}var Ka=1,La=2;function Ja(a){a=a.toLowerCase().split("-");var b=Ma[a[0]];b&&(a[0]=b);return a.join("-")}
var Ma={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function D(a){this.ya=new z;this.v=a}p("shaka.util.FakeEventTarget",D);D.prototype.addEventListener=function(a,b,c){c||this.ya.push(a,b)};D.prototype.removeEventListener=function(a,b,c){c||ta(this.ya,a,b)};
D.prototype.dispatchEvent=function(a){a.hasOwnProperty("srcElement")||(delete a.srcElement,Object.defineProperty(a,"srcElement",{get:function(){return null}}));if(a.hasOwnProperty("target"))a.target=this;else{delete a.target;var b=this;Object.defineProperty(a,"target",{get:function(){return b},set:function(a){b=a}})}if(a.hasOwnProperty("currentTarget"))a.currentTarget=null;else{delete a.currentTarget;var c=null;Object.defineProperty(a,"currentTarget",{get:function(){return c},set:function(a){c=a}})}return Na(this,
a)};function Na(a,b){b.currentTarget=a;for(var c=a.ya.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.v&&b.bubbles&&Na(a.v,b);return b.defaultPrevented};function Oa(a,b){D.call(this,b);this.a=null;this.h=a}q(Oa,D);
function Pa(a){if(!window.indexedDB)return a=Error("Persistant storage requires IndexedDB support."),a.type="storage",Promise.reject(a);if(a.a)return a=Error("A database connection is already open."),a.type="storage",Promise.reject(a);var b=new y,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=x(a,function(a){this.a=a.target.result;Qa(this,"group_store",{keyPath:"group_id"});Qa(this,"stream_index_store",{keyPath:"stream_id"});a=Qa(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",
["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=x(a,function(a){this.a=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function Ra(a){a.a&&(a.a.close(),a.a=null)}function Qa(a,b,c){a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c)}function Sa(a){return Ta(a,"content_store")}function Ua(a){return Ta(a,"stream_index_store")}function Va(a){return Ta(a,"group_store")}
function Ta(a,b){return a.a.transaction([b],a.h).objectStore(b)}function Wa(a,b){var c=new y,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c};function Xa(){Oa.call(this,"readonly",null)}q(Xa,Oa);function Ya(a){var b=new y,c=[],d=Va(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function Za(a,b){return Wa(Va(a),b).then(x(a,function(a){a.session_ids=ra(a.session_ids);return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):$a(this,a.stream_ids[0]).then(function(b){a.duration=b.duration;a.key_system=b.key_system;a.license_server=b.license_server;a.with_credentials=b.with_credentials;a.distinctive_identifier=b.distinctive_identifier;a.audio_robustness=b.audio_robustness;a.video_robustness=b.video_robustness;return Promise.resolve(a)})}))}
function $a(a,b){return Wa(Ua(a),b)}function ab(a,b,c){return Wa(Sa(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})};function E(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function F(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function bb(){D.call(this,null);this.a=new Da(3);this.c=new Da(10);this.b=0}q(bb,D);p("shaka.util.EWMABandwidthEstimator",bb);bb.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(E({type:"bandwidth"}));this.b=Date.now()}};bb.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(Ea(this.a),Ea(this.c))};bb.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
bb.prototype.supportsCaching=function(){return!1};function da(a){var b=cb;this.b=a;this.c=b==db;this.a=0}var cb=0,db=1;function eb(a){return a.a<a.b.byteLength}function ia(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function G(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function fb(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function gb(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function w(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function hb(){this.g=new y;this.f=!1;this.a=null;this.b=[];this.c=null}function ib(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}hb.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});jb(this,void 0)};hb.prototype.end=function(){this.b.splice(1)};
function jb(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(x(a,function(a){this.a?(this.b=[],this.c=null,kb(this)):(this.b.shift(),this.b.length?jb(this,a):(this.g.resolve(a),this.c=null))})).catch(x(a,function(a){this.b=[];this.c=null;this.a?kb(this):this.g.reject(a)}))}function kb(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function lb(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}lb("error");lb("warn");lb("info");lb("log");lb("debug");function mb(a){this.systemIds=[];this.cencKeyIds=[];this.a=[];a=new da(new DataView(a.buffer));try{for(;eb(a);){var b=a.a,c=G(a),d=G(a);1==c?c=fb(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)w(a,c-(a.a-b));else{var e=ia(a);if(1<e)w(a,c-(a.a-b));else{w(a,3);var f=qa(gb(a)),g=[];if(0<e)for(var h=G(a),l=0;l<h;++l){var m=qa(gb(a));g.push(m)}var n=G(a);w(a,n);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);this.a.push({start:b,end:a.a-1});a.a!=b+c&&w(a,c-(a.a-b))}}}}catch(t){}};function nb(a){ob[a]={na:pb(),end:NaN}}function qb(a){if(a=ob[a])a.end=pb()}function rb(a){return(a=ob[a])&&a.end?a.end-a.na:NaN}var pb=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,ob={};function sb(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.i=a;this.c=b;this.l=c;this.j=new A;this.g=null;this.b=[];this.w=0;this.f=this.a=null;this.s=0;B(this.j,this.c,"updateend",this.B.bind(this))}var tb=1/60;sb.prototype.destroy=function(){ub(this).catch(function(){});this.f&&this.f.destroy();this.a=this.f=null;this.g&&(Ra(this.g),this.g=null);this.b=null;this.j.destroy();this.i=this.c=this.j=null};
function vb(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-tb,f=c.end(d)+tb;if(b>=e&&b<=f)return c.end(d)-b}return 0}
function wb(a,b,c,d){if(a.a)return a=Error("Cannot fetch ("+a.v+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new hb;c!=a.c.timestampOffset&&(a.c.timestampOffset=c);"idb"!=b.url.b[0].P||a.g||(a.g=new Xa,ib(a.a,function(){return[Pa(this.g)]}.bind(a)));d&&ib(a.a,function(){return[xb(this,d),this.h.bind(this)]}.bind(a));ib(a.a,function(){var a=b.a?b.a-b.b:1,c=new yb;c.a=3;c.h=1E3*a;c.c=1E3*this.s;c.i=this.g;return[zb(b.url,c,this.l),H.prototype.g.bind(b.url)]}.bind(a));
ib(a.a,x(a,function(a){this.l.getBandwidth();return[xb(this,a),this.h.bind(this)]}));var e=0==a.c.buffered.length&&0==a.b.length,f=null;ib(a.a,function(){if(0==this.c.buffered.length){var a=Error("Failed to buffer segment ("+this.v+").");a.type="stream";return[Promise.reject(a)]}e&&(a=b.b,f=this.c.buffered.start(0)-a);a=Ab(this.b,b.b);0<=a?this.b.splice(a+1,0,b):this.b.push(b)}.bind(a));return Bb(a).then(function(){return Promise.resolve(f)}.bind(a))}
function Cb(a){if(a.a)return a=Error("Cannot clear ("+a.v+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new hb;ib(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,this.i.duration)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new y}return[a,this.h.bind(this)]}.bind(a));return Bb(a)}
function Db(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.v+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new hb;ib(a.a,function(){return[Eb(this,b),this.h.bind(this)]}.bind(a));return Bb(a)}function ub(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new y,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function Bb(a){a.a.start();return a.a.g.then(x(a,function(){this.a=null})).catch(x(a,function(a){this.a=null;return Promise.reject(a)}))}
function xb(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new y;return a.f}function Eb(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=Ab(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].b,a.i.duration)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new y;return a.f}sb.prototype.h=function(){this.f&&"open"==this.i.readyState&&this.c.abort()};sb.prototype.B=function(){this.f&&(this.f.resolve(),this.f=null)};function I(){this.fontSize="100%";this.fontColor=Fb;this.fontOpacity=Gb;this.backgroundColor=Hb;this.backgroundOpacity=Gb;this.fontEdge=Ib}p("shaka.player.TextStyle",I);I.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};I.prototype.load=I.prototype.a;I.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
I.prototype.store=I.prototype.b;function Jb(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+Kb(a.fontColor,a.fontOpacity));b.push("background-color: "+Kb(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(Kb(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function Kb(a,b){return"rgba("+a.concat(b).join(",")+")"}var Fb=[255,255,255],Hb=[0,0,0];
I.StandardColors={WHITE:Fb,BLACK:Hb,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var Gb=1;I.StandardOpacities={OPAQUE:Gb,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var Ib=[];
I.EdgeStyles={NONE:Ib,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function Lb(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function Mb(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}p("shaka.player.VideoTrack.compare",Mb);function Nb(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}p("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function Ob(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}p("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function Pb(){this.h=this.a="";this.i=!1;this.s=this.l=null;this.v=this.g=!1;this.j=this.f="";this.c=null;this.b=[]}
function Rb(a){var b=new Pb;if(!a)return b;var c=Aa(a,"keySystem");if(null!=c)b.a=c;else throw Error("'keySystem' cannot be null.");var d=Aa(a,"licenseServerUrl");if(null!=d)b.h=d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");c=xa(a,"withCredentials");null!=c&&(b.i=c);c=Ba(a,"licensePostProcessor",Function);null!=c&&(b.l=c);c=Ba(a,"licensePreProcessor",Function);null!=c&&(b.s=c);c=xa(a,"distinctiveIdentifierRequired");null!=c&&(b.g=c);c=xa(a,
"persistentStateRequired");null!=c&&(b.v=c);c=Aa(a,"audioRobustness");null!=c&&(b.f=c);c=Aa(a,"videoRobustness");null!=c&&(b.j=c);c=Ba(a,"serverCertificate",Uint8Array);null!=c&&(b.c=c);if(c=Ba(a,"initData",Object)){a=Ba(c,"initData",Uint8Array);if(null==a)throw Error("'initData.initData' cannot be null.");c=Aa(c,"initDataType");if(null==c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c})}return b}
function Sb(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=ra(c,Tb)}function Tb(a,b){return a.initDataType==b.initDataType&&ga(a.initData,b.initData)};function Ub(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.minHeight=this.maxHeight=null}Ub.prototype.clone=function(){var a=new Ub;a.maxHeight=this.maxHeight;a.minHeight=this.minHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function Vb(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
Wb);document.addEventListener("webkitfullscreenerror",Wb);document.addEventListener("mozfullscreenchange",Wb);document.addEventListener("mozfullscreenerror",Wb);document.addEventListener("MSFullscreenChange",Wb);document.addEventListener("MSFullscreenError",Wb)}p("shaka.polyfill.Fullscreen.install",Vb);function Wb(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function J(a){this.c=[];this.b=[];this.ba=Xb;if(a)try{a(this.W.bind(this),this.a.bind(this))}catch(b){this.a(b)}}var Xb=0;function Yb(){window.Promise||(window.Promise=J,window.Promise.resolve=Zb,window.Promise.reject=$b,window.Promise.all=ac,window.Promise.race=bc,window.setImmediate?(cc=function(a){return window.setImmediate(a)},dc=function(a){return window.clearImmediate(a)}):(cc=function(a){return window.setTimeout(a,0)},dc=function(a){return window.clearTimeout(a)}))}
p("shaka.polyfill.Promise.install",Yb);function Zb(a){var b=new J;b.W(a);return b}function $b(a){var b=new J;b.a(a);return b}function ac(a){function b(a,b,c){a.ba==Xb&&(e[b]=c,d++,d==e.length&&a.W(e))}var c=new J;if(!a.length)return c.W([]),c;for(var d=0,e=Array(a.length),f=c.a.bind(c),g=0;g<a.length;++g)a[g]&&a[g].then?a[g].then(b.bind(null,c,g),f):b(c,g,a[g]);return c}function bc(a){for(var b=new J,c=b.W.bind(b),d=b.a.bind(b),e=0;e<a.length;++e)a[e]&&a[e].then?a[e].then(c,d):c(a[e]);return b}
J.prototype.then=function(a,b){var c=new J;switch(this.ba){case 1:ec(this,c,a);break;case 2:ec(this,c,b);break;case Xb:this.c.push({Ja:c,Ca:a}),this.b.push({Ja:c,Ca:b})}return c};J.prototype.then=J.prototype.then;J.prototype.catch=function(a){return this.then(void 0,a)};J.prototype["catch"]=J.prototype.catch;J.prototype.W=function(a){if(this.ba==Xb){this.wa=a;this.ba=1;for(a=0;a<this.c.length;++a)ec(this,this.c[a].Ja,this.c[a].Ca);this.c=[];this.b=[]}};
J.prototype.a=function(a){if(this.ba==Xb){this.wa=a;this.ba=2;for(a=0;a<this.b.length;++a)ec(this,this.b[a].Ja,this.b[a].Ca);this.c=[];this.b=[]}};function ec(a,b,c){fc.push(function(){if(c&&"function"==typeof c){try{var a=c(this.wa)}catch(e){b.a(e);return}a instanceof J?a==b?b.a(new TypeError("Chaining cycle detected")):a.then(b.W.bind(b),b.a.bind(b)):b.W(a)}else 1==this.ba?b.W(this.wa):b.a(this.wa)}.bind(a));null==gc&&(gc=cc(hc))}
function hc(){for(;fc.length;){null!=gc&&(dc(gc),gc=null);var a=fc;fc=[];for(var b=0;b<a.length;++b)a[b]()}}function cc(){return 0}function dc(){}var gc=null,fc=[];function ic(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=jc)}p("shaka.polyfill.VideoPlaybackQuality.install",ic);function jc(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function kc(a,b){try{var c=new lc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function mc(a){var b=this.mediaKeys;b&&b!=a&&nc(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&nc(a,this);return Promise.resolve()}
function lc(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},l=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var n=g.audioCapabilities[m];
n.contentType&&(l=!0,e.canPlayType(n.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(n),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)n=g.videoCapabilities[m],n.contentType&&(l=!0,e.canPlayType(n.contentType,this.a)&&(h.videoCapabilities.push(n),d=!0));l||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}c=
"Unsupported keySystem";if("org.w3.clearkey"==a||"com.widevine.alpha"==a)c="None of the requested configurations were supported.";c=Error(c);c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}lc.prototype.createMediaKeys=function(){var a=new oc(this.a);return Promise.resolve(a)};lc.prototype.getConfiguration=function(){return this.b};function oc(a){this.g=a;this.b=null;this.a=new A;this.c=[];this.f={}}
function nc(a,b){a.b=b;Fa(a.a);b&&(B(a.a,b,"webkitneedkey",a.Sb.bind(a)),B(a.a,b,"webkitkeymessage",a.Rb.bind(a)),B(a.a,b,"webkitkeyadded",a.Pb.bind(a)),B(a.a,b,"webkitkeyerror",a.Qb.bind(a)))}k=oc.prototype;k.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new pc(a,this.g,b);this.c.push(b);return b};
k.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};k.Sb=function(a){a=E({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};k.Rb=function(a){var b=qc(this,a.sessionId);b&&(a=E({type:"message",messageType:void 0==b.keyStatuses.Ga()?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};
k.Pb=function(a){if(a=qc(this,a.sessionId))rc(a,"usable"),a.a&&a.a.resolve(),a.a=null};
k.Qb=function(a){var b=qc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?rc(b,"output-restricted"):1==c?rc(b,"expired"):rc(b,"internal-error"))}};
function qc(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function pc(a,b,c){D.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new y;this.keyStatuses=new sc}q(pc,D);
function tc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=oa("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=oa("PERSISTENT|"+na(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new y;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}k=pc.prototype;k.Ra=function(a,b){if(this.a)this.a.then(this.Ra.bind(this,a,b)).catch(this.Ra.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=na(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=pa(d.keys[0].k),d=pa(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function rc(a,b){a.keyStatuses.Na(b);var c=E({type:"keystatuseschange"});a.dispatchEvent(c)}k.generateRequest=function(a,b){return tc(this,b,null)};k.load=function(a){return"persistent-license"==this.g?tc(this,null,a):Promise.reject(Error("Not a persistent session."))};k.update=function(a){var b=new y;this.Ra(b,a);return b};
k.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};k.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function uc(a){this.b=a;this.a=0}
uc.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function sc(){this.size=0;this.a=void 0}var vc;k=sc.prototype;k.Na=function(a){this.size=void 0==a?0:1;this.a=a};k.Ga=function(){return this.a};k.entries=function(){var a=vc,b=[];this.a&&b.push([a,this.a]);return new uc(b)};k.forEach=function(a){this.a&&a(this.a,vc)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=vc;return this.a&&ga(new Uint8Array(a),b)?!0:!1};
k.keys=function(){var a=vc,b=[];this.a&&b.push(a);return new uc(b)};k.values=function(){var a=[];this.a&&a.push(this.a);return new uc(a)};function wc(a,b){try{var c=new xc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}
function xc(a,b){this.keySystem=a;for(var c=!1,d=0;d<b.length;++d){var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"]},g=!1;if(e.audioCapabilities)for(var h=0;h<e.audioCapabilities.length;++h){var l=e.audioCapabilities[h];if(l.contentType){var g=!0,m=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,m)&&(f.audioCapabilities.push(l),c=!0)}}if(e.videoCapabilities)for(h=
0;h<e.videoCapabilities.length;++h)l=e.videoCapabilities[h],l.contentType&&(g=!0,m=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,m)&&(f.videoCapabilities.push(l),c=!0));g||(c=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==e.persistentState&&(f.persistentState="required",f.sessionTypes=["persistent-license"]);if(c){this.a=f;return}}c=Error("Unsupported keySystem");c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}
xc.prototype.createMediaKeys=function(){var a=new yc(this.keySystem);return Promise.resolve(a)};xc.prototype.getConfiguration=function(){return this.a};function zc(a){var b=this.mediaKeys;b&&b!=a&&Ac(b,null);delete this.mediaKeys;return(this.mediaKeys=a)?Ac(a,this):Promise.resolve()}function yc(a){this.a=new MSMediaKeys(a);this.b=new A}yc.prototype.createSession=function(a){if("temporary"!=(a||"temporary"))throw new TypeError("Session type "+a+" is unsupported on this platform.");return new Bc(this.a)};
yc.prototype.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};function Ac(a,b){function c(){b.msSetMediaKeys(d.a);b.removeEventListener("loadedmetadata",c)}Fa(a.b);if(!b)return Promise.resolve();B(a.b,b,"msneedkey",Cc);var d=a;try{return 1<=b.readyState?b.msSetMediaKeys(a.a):b.addEventListener("loadedmetadata",c),Promise.resolve()}catch(e){return Promise.reject(e)}}
function Bc(a){D.call(this,null);this.c=null;this.g=a;this.b=this.a=null;this.f=new A;this.sessionId="";this.expiration=NaN;this.closed=new y;this.keyStatuses=new Dc}q(Bc,D);k=Bc.prototype;k.generateRequest=function(a,b){this.a=new y;try{this.c=this.g.createSession("video/mp4",b),B(this.f,this.c,"mskeymessage",this.Eb.bind(this)),B(this.f,this.c,"mskeyadded",this.Cb.bind(this)),B(this.f,this.c,"mskeyerror",this.Db.bind(this)),Ec(this,"status-pending")}catch(c){this.a.reject(c)}return this.a};
k.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))};k.update=function(a){this.b=new y;try{this.c.update(a)}catch(b){this.b.reject(b)}return this.b};k.close=function(){try{this.c.close(),this.closed.resolve(),Fa(this.f)}catch(a){this.closed.reject(a)}return this.closed};k.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Cc(a){var b=a.initData;if(b){var c=new mb(b);if(1>=c.a.length)a=b;else{var d=[];for(a=0;a<c.a.length;a++)d.push(b.subarray(c.a[a].start,c.a[a].end+1));b=ra(d,Fc);for(a=c=0;a<b.length;a++)c+=b[a].length;c=new Uint8Array(c);for(a=d=0;a<b.length;a++)c.set(b[a],d),d+=b[a].length;a=c}}else a=b;a=E({type:"encrypted",initDataType:"cenc",initData:a});this.dispatchEvent(a)}function Fc(a,b){return ga(a,b)}
k.Eb=function(a){this.a&&(this.a.resolve(),this.a=null);a=E({type:"message",messageType:void 0==this.keyStatuses.Ga()?"licenserequest":"licenserenewal",message:a.message.buffer});this.dispatchEvent(a)};k.Cb=function(){this.a?(this.a.resolve(),this.a=null):this.b&&(Ec(this,"usable"),this.b.resolve(),this.b=null)};
k.Db=function(){var a=Error("EME v20140218 key error");a.errorCode=this.c.error;if(null!=this.a)this.a.reject(a),this.a=null;else if(null!=this.b)this.b.reject(a),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Ec(this,"output-not-allowed");default:Ec(this,"internal-error")}};function Ec(a,b){a.keyStatuses.Na(b);var c=E({type:"keystatuseschange"});a.dispatchEvent(c)}function Gc(a){this.b=a;this.a=0}
Gc.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function Dc(){this.size=0;this.a=void 0}var Hc;k=Dc.prototype;k.Na=function(a){this.size=void 0==a?0:1;this.a=a};k.Ga=function(){return this.a};k.entries=function(){var a=Hc,b=[];this.a&&b.push([a,this.a]);return new Gc(b)};k.forEach=function(a){this.a&&a(this.a,Hc)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=Hc;return this.a&&ga(new Uint8Array(a),b)?!0:!1};
k.keys=function(){var a=Hc,b=[];this.a&&b.push(a);return new Gc(b)};k.values=function(){var a=[];this.a&&a.push(this.a);return new Gc(a)};function Ic(){return Promise.reject(Error("The key system specified is not supported."))}function Jc(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Kc(){throw new TypeError("Illegal constructor.");}Kc.prototype.createSession=function(){};Kc.prototype.setServerCertificate=function(){};function Lc(){throw new TypeError("Illegal constructor.");}Lc.prototype.getConfiguration=function(){};Lc.prototype.createMediaKeys=function(){};function Mc(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(vc=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=kc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=mc,window.MediaKeys=oc,window.MediaKeySystemAccess=lc):window.MSMediaKeys?(Hc=new Uint8Array([0]),delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=zc,window.MediaKeys=yc,window.MediaKeySystemAccess=xc,Navigator.prototype.requestMediaKeySystemAccess=wc):(Navigator.prototype.requestMediaKeySystemAccess=Ic,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Jc,window.MediaKeys=Kc,window.MediaKeySystemAccess=Lc))}p("shaka.polyfill.MediaKeys.install",Mc);function Nc(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=Oc)}p("shaka.polyfill.CustomEvent.install",Nc);function Oc(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};p("shaka.polyfill.installAll",function(){Nc();Vb();ic();Yb();Mc()});var Pc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function K(a){var b;a instanceof K?(Qc(this,a.P),this.ca=a.ca,this.S=a.S,Rc(this,a.ia),this.O=a.O,Sc(this,a.a.clone()),this.aa=a.aa):a&&(b=String(a).match(Pc))?(Qc(this,b[1]||"",!0),this.ca=Tc(b[2]||""),this.S=Tc(b[3]||"",!0),Rc(this,b[4]),this.O=Tc(b[5]||"",!0),Sc(this,b[6]||"",!0),this.aa=Tc(b[7]||"")):this.a=new Vc(null)}k=K.prototype;k.P="";k.ca="";k.S="";k.ia=null;k.O="";k.aa="";
k.toString=function(){var a=[],b=this.P;b&&a.push(Wc(b,Xc,!0),":");if(b=this.S){a.push("//");var c=this.ca;c&&a.push(Wc(c,Xc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.ia;null!=b&&a.push(":",String(b))}if(b=this.O)this.S&&"/"!=b.charAt(0)&&a.push("/"),a.push(Wc(b,"/"==b.charAt(0)?Yc:Zc,!0));(b=this.a.toString())&&a.push("?",b);(b=this.aa)&&a.push("#",Wc(b,$c));return a.join("")};
k.resolve=function(a){var b=this.clone();"data"===b.P&&(b=new K);var c=!!a.P;c?Qc(b,a.P):c=!!a.ca;c?b.ca=a.ca:c=!!a.S;c?b.S=a.S:c=null!=a.ia;var d=a.O;if(c)Rc(b,a.ia);else if(c=!!a.O){if("/"!=d.charAt(0))if(this.S&&!this.O)d="/"+d;else{var e=b.O.lastIndexOf("/");-1!=e&&(d=b.O.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.O=d:c=""!==a.a.toString();c?Sc(b,a.a.clone()):c=!!a.aa;c&&(b.aa=a.aa);return b};k.clone=function(){return new K(this)};function Qc(a,b,c){a.P=c?Tc(b,!0):b;a.P&&(a.P=a.P.replace(/:$/,""))}function Rc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.ia=b}else a.ia=null}function Sc(a,b,c){b instanceof Vc?a.a=b:(c||(b=Wc(b,ad)),a.a=new Vc(b))}
function Tc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function Wc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,bd),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function bd(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Xc=/[#\/\?@]/g,Zc=/[\#\?:]/g,Yc=/[\#\?]/g,ad=/[\#\?@]/g,$c=/#/g;function Vc(a){this.b=a||null}Vc.prototype.a=null;Vc.prototype.c=null;
function cd(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";cd(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
Vc.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};Vc.prototype.clone=function(){var a=new Vc;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function dd(){this.id=this.url=null;this.type="static";this.b=this.j=this.u=this.jb=null;this.h=5;this.f=this.c=this.g=null;this.i=1;this.a=[]}function ed(){this.g=this.f=this.c=this.u=this.a=this.start=this.id=null;this.b=[]}function fd(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.u=null;this.j=[];this.a=[]}function gd(){this.value=null}function hd(){this.contentType=this.lang=this.id=null}
function id(){this.a=this.b=this.g=this.u=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[]}function jd(){this.b=this.a=this.c=this.f=null}function kd(){this.parsedPssh=this.psshBox=null}function ld(){this.url=null}function md(){this.url=null}function nd(){this.u=null;this.g=1;this.c=this.b=this.a=this.f=null}nd.prototype.clone=function(){var a=new nd;a.u=od(this.u);a.g=this.g;a.f=this.f;a.a=L(this.a);a.b=L(this.b);a.c=L(this.c);return a};
function pd(){this.a=this.url=null}pd.prototype.clone=function(){var a=new pd;a.url=od(this.url);a.a=L(this.a);return a};function qd(){this.a=this.url=null}qd.prototype.clone=function(){var a=new qd;a.url=od(this.url);a.a=L(this.a);return a};function rd(){this.u=null;this.f=1;this.b=this.g=null;this.i=1;this.h=null;this.a=[];this.c=null}rd.prototype.clone=function(){var a=new rd;a.u=od(this.u);a.f=this.f;a.g=this.g;a.b=this.b;a.i=this.i;a.h=L(this.h);a.a=od(this.a)||[];a.c=L(this.c);return a};
function sd(){this.a=this.b=null}sd.prototype.clone=function(){var a=new sd;a.b=od(this.b);a.a=L(this.a);return a};function td(){this.a=1;this.b=this.i=null;this.j=1;this.c=this.g=this.f=this.h=null}td.prototype.clone=function(){var a=new td;a.a=this.a;a.i=this.i;a.b=this.b;a.j=this.j;a.h=this.h;a.f=this.f;a.g=this.g;a.c=L(this.c);return a};function ud(){this.a=[]}ud.prototype.clone=function(){var a=new ud;a.a=od(this.a)||[];return a};function vd(){this.c=this.a=this.b=null}
vd.prototype.clone=function(){var a=new vd;a.b=this.b;a.a=this.a;a.c=this.c;return a};function wd(a,b){this.na=a;this.end=b}wd.prototype.clone=function(){return new wd(this.na,this.end)};dd.TAG_NAME="MPD";ed.TAG_NAME="Period";fd.TAG_NAME="AdaptationSet";gd.TAG_NAME="Role";hd.TAG_NAME="ContentComponent";id.TAG_NAME="Representation";jd.TAG_NAME="ContentProtection";kd.TAG_NAME="cenc:pssh";ld.TAG_NAME="BaseURL";md.TAG_NAME="Location";nd.TAG_NAME="SegmentBase";pd.TAG_NAME="RepresentationIndex";
qd.TAG_NAME="Initialization";rd.TAG_NAME="SegmentList";sd.TAG_NAME="SegmentURL";td.TAG_NAME="SegmentTemplate";ud.TAG_NAME="SegmentTimeline";vd.TAG_NAME="S";
dd.prototype.parse=function(a,b){this.url=a.jb;this.id=M(b,"id",N);this.type=M(b,"type",N)||"static";this.b=M(b,"mediaPresentationDuration",xd);this.h=M(b,"minBufferTime",xd,this.h);this.g=M(b,"minimumUpdatePeriod",xd,this.g);this.c=M(b,"availabilityStartTime",yd,this.c);this.f=M(b,"timeShiftBufferDepth",xd,this.f);this.i=M(b,"suggestedPresentationDelay",xd,this.i);var c=a.u,d=O(this,b,ld);this.u=zd(c,d);if(d=P(this,b,md))this.j=Ad(c,d.url);this.a=O(this,b,ed)};
ed.prototype.parse=function(a,b){this.id=M(b,"id",N);this.start=M(b,"start",xd);this.a=M(b,"duration",xd);var c=O(this,b,ld);this.u=zd(a.u,c);this.c=P(this,b,nd);this.f=P(this,b,rd);this.g=P(this,b,td);this.b=O(this,b,fd);Bd(this)};function Bd(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
fd.prototype.parse=function(a,b){var c=P(this,b,hd)||{},d=P(this,b,gd);this.id=M(b,"id",N);this.group=M(b,"group",Q);this.lang=M(b,"lang",N,c.lang);this.contentType=M(b,"contentType",N,c.contentType);this.width=M(b,"width",R);this.height=M(b,"height",R);this.b=M(b,"mimeType",N);this.i=M(b,"codecs",N);this.c=d&&"main"==d.value;this.lang&&(this.lang=Ja(this.lang));c=O(this,b,ld);this.u=zd(a.u,c);this.j=O(this,b,jd);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?Cd(this,
b,a.c):P(this,b,nd);this.g=a.f?Cd(this,b,a.f):P(this,b,rd);this.h=a.g?Cd(this,b,a.g):P(this,b,td);this.a=O(this,b,id);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};gd.prototype.parse=function(a,b){this.value=M(b,"value",N)};hd.prototype.parse=function(a,b){this.id=M(b,"id",N);this.lang=M(b,"lang",N);this.contentType=M(b,"contentType",N);this.lang&&(this.lang=Ja(this.lang))};
id.prototype.parse=function(a,b){this.id=M(b,"id",N);this.bandwidth=M(b,"bandwidth",R);this.width=M(b,"width",R,a.width);this.height=M(b,"height",R,a.height);this.f=M(b,"mimeType",N,a.b);this.h=M(b,"codecs",N,a.i);this.lang=a.lang;var c=O(this,b,ld);this.u=zd(a.u,c);this.c=O(this,b,jd);this.g=a.f?Cd(this,b,a.f):P(this,b,nd);this.b=a.g?Cd(this,b,a.g):P(this,b,rd);this.a=a.h?Cd(this,b,a.h):P(this,b,td);this.c=this.c.concat(a.j)};
jd.prototype.parse=function(a,b){this.f=b;this.c=M(b,"schemeIdUri",N);var c=M(b,"cenc:default_KID",N);c&&(this.b=c.replace(/[-]/g,""));this.a=P(this,b,kd)};kd.prototype.parse=function(a,b){var c=Dd(b);if(c){this.psshBox=pa(c);try{this.parsedPssh=new mb(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};ld.prototype.parse=function(a,b){this.url=Dd(b)};md.prototype.parse=function(a,b){this.url=Dd(b)};
nd.prototype.parse=function(a,b){this.u=a.u||this.u;this.g=M(b,"timescale",R,this.g);this.f=M(b,"presentationTimeOffset",Q,this.f);this.a=M(b,"indexRange",Ed,this.a);this.b=P(this,b,pd)||this.b;this.c=P(this,b,qd)||this.c};pd.prototype.parse=function(a,b){var c=M(b,"sourceURL",N);this.url=Ad(a.u,c);this.a=M(b,"range",Ed,L(a.a))};qd.prototype.parse=function(a,b){var c=M(b,"sourceURL",N);this.url=Ad(a.u,c);this.a=M(b,"range",Ed)};
rd.prototype.parse=function(a,b){this.u=a.u||this.u;this.f=M(b,"timescale",R,this.f);this.g=M(b,"presentationTimeOffset",Q,this.g);this.b=M(b,"duration",R,this.b);var c=M(b,"startNumber",R);null!=c&&(this.i=c);this.h=P(this,b,qd)||this.h;this.a=(c=O(this,b,sd))&&0<c.length?c:this.a;this.c=P(this,b,ud)||this.c};sd.prototype.parse=function(a,b){var c=M(b,"media",N);this.b=Ad(a.u,c);this.a=M(b,"mediaRange",Ed)};
td.prototype.parse=function(a,b){this.a=M(b,"timescale",R,this.a);this.i=M(b,"presentationTimeOffset",Q,this.i);this.b=M(b,"duration",R,this.b);var c=M(b,"startNumber",Q);null!=c&&(this.j=c);this.h=M(b,"media",N,this.h);this.f=M(b,"index",N,this.f);this.g=M(b,"initialization",N,this.g);this.c=P(this,b,ud)||this.c};ud.prototype.parse=function(a,b){this.a=O(this,b,vd)};vd.prototype.parse=function(a,b){this.b=M(b,"t",Q);this.a=M(b,"d",Q);this.c=M(b,"r",Fd)};
function zd(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new K(e)):(e=Ad(a.slice(0,1),e),c.push(e[0]))}return c}function Ad(a,b){if(!b)return a;var c=new K(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function Cd(a,b,c){var d=L(c);(b=Gd(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function P(a,b,c){var d=null;if(b=Gd(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function Gd(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function O(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function Dd(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function od(a){return a?a.map(function(a){return a.clone()}):null}function L(a){return a?a.clone():null}
function M(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function yd(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function xd(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=Q(b[1]);c&&(a+=31536E3*c);(c=Q(b[2]))&&(a+=2592E3*c);(c=Q(b[3]))&&(a+=86400*c);(c=Q(b[4]))&&(a+=3600*c);(c=Q(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function Ed(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=Q(b[1]);if(null==a)return null;b=Q(b[2]);return null==b?null:new wd(a,b)}function Fd(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function R(a){a=window.parseInt(a,10);return 0<a?a:null}function Q(a){a=window.parseInt(a,10);return 0<=a?a:null}function N(a){return a};function Hd(a,b){this.url=a;this.b=b||new yb;this.g=this.i=this.h=0;this.a=null;this.c=new y;this.f=null}function yb(){this.body=null;this.a=1;this.h=1E3;this.c=0;this.method="GET";this.f="arraybuffer";this.b={};this.g=this.j=!1;this.i=null}var Id=!0;function Jd(a){Kd(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function Kd(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}k=Hd.prototype;
k.rb=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=oa(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);Jd(this);return b}if(0==this.url.lastIndexOf("idb:",0))return Ld(this);this.h++;this.i=Date.now();this.g||
(this.g=this.b.h);this.a=new XMLHttpRequest;a=this.url;Id&&(this.f&&!this.f.supportsCaching()||this.b.g)&&(a=new K(a),cd(a.a,"_",Date.now()),a=a.toString());this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.c;this.a.withCredentials=this.b.j;this.a.onload=this.Ab.bind(this);this.b.g&&(this.a.onreadystatechange=this.Hb.bind(this));this.a.onerror=this.Yb.bind(this);this.a.ontimeout=this.Mb.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);
return this.c};function Ld(a){var b=a.url.split("/");return ab(a.b.i,parseInt(b[2],10),parseInt(b[3],10)).then(x(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.c;a.resolve(b);Jd(this);return a})).catch(x(a,function(a){Jd(this);return Promise.reject(a)}))}function Md(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.bc=a.a;return b}
k.Ab=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),Jd(this)):this.h<this.b.a?Nd(this):(a=Md(this,"HTTP error.","net"),this.c.reject(a),Jd(this))};k.Hb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(la=a-Date.now())}};k.Yb=function(){var a=Md(this,"Network failure.","net");this.c.reject(a);Jd(this)};
k.Mb=function(){if(this.h<this.b.a)Nd(this);else{var a=Md(this,"Request timed out.","net");this.c.reject(a);Jd(this)}};function Nd(a){Kd(a);window.setTimeout(a.rb.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function H(a,b,c,d){this.b=b;this.f=c||0;this.i=null!=d?d:null;this.c=this.a=null;this.j=a;this.h=null}function Od(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}function zb(a,b,c){if(a.a)return a.a;b=b||new yb;if(a.f||a.i)b.b.Range="bytes="+(a.f+"-"+(null!=a.i?a.i:""));a.a=Pd(a,0,b,c);return a.a}
H.prototype.g=function(){if(this.c){this.a=null;var a=this.c;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=Md(a,"Request aborted.","aborted");a.c.reject(b);Jd(a)}this.h=this.c=null}};
function Pd(a,b,c,d){var e=a.b[b].toString();a.j&&(e=a.j(e,c.b)||e);a.c=new Hd(e,c);d&&(a.c.f=d);e=a.c.rb().then(x(a,function(a){this.h=this.c=this.a=null;this.h=a.a?new K(a.a):this.b[b];return Promise.resolve(a.response)}));return e=e.catch(x(a,function(a){if(this.a&&b+1<this.b.length)return this.a=Pd(this,b+1,c,d);this.a=this.c=null;return Promise.reject(a)}))}H.prototype.clone=function(){return new H(this.j,this.b.map(function(a){return a.clone()}),this.f,this.i)};H.prototype.toString=function(){return this.b[0].toString()};function Qd(a,b,c,d){for(var e=b.a,f=[],g=0;g<d;++g){var h=g+c,l=(h-1)*e.b,m=l/e.a,n=(l+e.b)/e.a,h=Rd(a,b,e.j+h-1,l);if(!h)return null;f.push(new Sd(m,n,h))}return f}function Rd(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.u?new H(a,b.u,0,null):null;c=Td(e,b.id,c,b.bandwidth,d);if(!c)return null;b=Od(b.u,c);return new H(a,b,0,null)}
function Td(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new K(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function Ud(a,b,c){var d=0;b*=c;a=a.a;c=[];for(var e=0;e<a.length&&a[e].a;++e){var f=a[e].b,f=null!=f?f:d,g=a[e].c||0;0>g&&(g=a[e].a,g=e+1===a.length?Math.ceil((a[0].b+b-f)/g)-1:Math.ceil((a[e+1].b-f)/g)-1);0<c.length&&f!=d&&(c[c.length-1].end=f);for(var h=0;h<=g;++h)d=f+a[e].a,c.push({start:f,end:d}),f=d}return c};function Vd(a,b){this.a=new yb;this.a.f="text";this.a.a=300;this.a.c=1E4*(null!=b?b:0);this.a.g=!0;this.b=a}function Wd(a){var b=a.b;return zb(b,a.a).then(function(a){var d;d=b.b;var e=[b.h];d=(a=(new DOMParser).parseFromString(a,"text/xml"))?P({jb:d,u:e},a,dd):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="dash";return Promise.reject(d)})};function Xd(a,b,c,d,e,f){this.b=new H(null,[new K(a)]);this.a=new yb;this.a.body=b;this.a.method=c;this.a.a=3;this.a.j=d;this.a.c=1E3*(null!=f?f:0);a=e||{};for(var g in a)this.a.b[g]=a[g]}function Yd(a){return zb(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function Zd(a,b){this.a=a;this.b=b||null}Zd.prototype.destroy=function(){this.a&&(this.a.g(),this.a=null);this.b=null};Zd.prototype.create=function(){return this.a?zb(this.a):Promise.resolve(this.b)};function Sd(a,b,c){this.b=a;this.a=b;this.url=c}function $d(a,b,c){return new Sd(b,c,a.url)}function Ab(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.b&&(null==d.a||b<d.a))return c}return-1}function ae(a,b){return a.map(function(a){return $d(a,a.b+b,null!=a.a?a.a+b:null)})};function S(a){this.o=a;this.i=0}S.prototype.destroy=function(){this.o=null};k=S.prototype;k.length=function(){return this.o.length};function T(a){if(0==a.o.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.o[0]}k.A=function(){if(0==this.o.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.o[this.o.length-1]};
k.get=function(a){if(0>a||a>=this.o.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.o[a]};k.la=function(a){a=Ab(this.o,a);return 0<=a?this.o[a]:null};k.Ia=function(a){be(this,a);return!0};
function be(a,b){a.i!=b.i&&(b=new S(ae(b.o,a.i-b.i)));if(0==a.length())a.o=b.o.slice(0);else if(0!=b.length()&&null!=a.A().a&&!(null!=b.A().a&&b.A().a<a.A().a)){if(a.A().a<=T(b).b)var c=$d(a.A(),a.A().b,T(b).b),c=a.o.slice(0,-1).concat([c]);else{var d;for(d=0;d<a.o.length&&!(a.o[d].a>=T(b).b);++d);a.o[d].b<T(b).b?(c=$d(a.o[d],a.o[d].b,T(b).b),c=a.o.slice(0,d).concat([c])):(T(a).b>T(b).b||T(b),c=a.o.slice(0,d))}a.o=c.concat(b.o)}}
k.ka=function(a){var b=a-this.i;if(0==b)return 0;this.o=ae(this.o,b);this.i=a;return b};k.Fa=function(){return 0<this.length()?{start:T(this).b,end:this.A().a}:{start:0,end:0}};function U(a,b,c,d){S.call(this,a);this.g=b;this.w=c;this.f=d;this.h=this.g.b||this.g.a.reduce(function(a,b){return null==b.a?NaN:a+b.a},0)||0;this.a=this.l=this.c=null;ce(this)}q(U,S);U.prototype.destroy=function(){this.w=this.g=null;S.prototype.destroy.call(this)};U.prototype.la=function(a){de(this,ka()/1E3);return S.prototype.la.call(this,a)};U.prototype.Ia=function(a){if(!(a instanceof U))return!1;be(this,a);this.h=Math.max(this.h,a.h);null==this.c?(this.f=a.f,ce(this)):oe(this);return!0};
function ce(a){oe(a);if(0!=a.length()){a.length();var b=null!=a.A().a?a.A().a:a.A().b;if(a.g.c>a.f)a.c=b;else{var c=a.f-(a.g.c+a.w.start);0>c?a.c=b:c<Math.max(a.A().b,a.A().a||0)?(a.A(),a.c=b):a.c=c}a.l=a.A().b;a.a=T(a).b}}U.prototype.ka=function(a){a=S.prototype.ka.call(this,a);Math.min.apply(null,this.o.filter(function(a){return null!=a.a}).map(function(a){return a.a-a.b}));null!=this.c&&(this.l+=a,this.a+=a,this.c+=a);return a};U.prototype.Fa=function(){return pe(this,ka()/1E3)};
function pe(a,b){de(a,b);if(null==a.c||null==a.l||null==a.a)return{start:0,end:0};var c=Number.POSITIVE_INFINITY;a.h&&(c=a.h);var d=b-a.f,e=a.c+d;null!=a.g.f&&(e=e-a.a-a.g.f,0<e&&(a.a+=e));a.a=Math.min(a.a,c);d=a.l+d;if(d<a.a)return{start:a.a,end:a.a};d=0<a.length()?null!=a.A().a?Math.min(d,a.A().a):d:a.a;d=Math.max(d,a.a);d=Math.min(d,c);return{start:a.a,end:d}}
function de(a,b){oe(a);if(null!=a.g.f)if(null==a.c)a.length();else{for(var c=a.c+(b-a.f),d=0,e=0;e<a.o.length;++e){var f=null;e<a.o.length-1?f=a.o[e+1].a:(f=a.o[e],f=null!=f.a?f.a+(f.a-f.b):null);if(null!=f&&f<c-a.g.f)++d;else break}0<d&&a.o.splice(0,d)}}function oe(a){if(a.h){for(var b=0,c=a.o.length-1;0<=c;--c)if(a.o[c].b>a.h)++b;else break;0<b&&a.o.splice(-b)}};function qe(a,b,c,d,e){var f=1,g=0,h;if(a.c>d)h=null;else{var l=a.i||0,m=a.f||0;h=c.a;h=h.b/h.a;var n=d-(a.c+b.start);0>n?h=null:(m=n-2*h-m,0>m&&(m=0),m=Math.ceil(m/h)*h,n-=h,0>n?h=null:(l=Math.floor(n/h)*h-l,0>l&&(l=0),l=Math.floor(l/h)*h,h={Za:m/h+1,current:(l>=m?l:m)/h+1}))}h&&(f=h.Za,g=h.current-h.Za+1);f=Qd(e,c,f,g);if(null==f)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;U.call(this,f,a,b,d);this.s=c;this.v=this.b=0<this.length()?a.c+b.start+this.A().a:null;this.j=
h?h.current+1:null;this.B=e}q(qe,U);qe.prototype.destroy=function(){this.B=this.s=null;U.prototype.destroy.call(this)};qe.prototype.la=function(a){var b=ka()/1E3;re(this,b);de(this,b);return S.prototype.la.call(this,a)};qe.prototype.Ia=function(a){if(null!=this.b||!(a instanceof qe)||null==a.b)return!1;this.b=a.b;this.v=a.v;this.j=a.j;this.f=a.f;this.h=a.h;be(this,a);re(this,ka()/1E3);ce(this);return!0};
qe.prototype.ka=function(a){a=U.prototype.ka.call(this,a);null!=this.b&&(this.b+=a,this.v+=a);return a};qe.prototype.Fa=function(){var a=ka()/1E3;re(this,a);return pe(this,a)};function re(a,b){if(null!=a.b&&null!=a.v&&null!=a.j){var c=a.s.a,c=c.b/c.a,d=Math.floor((a.v+(b-a.f)-a.b)/c);if(0!=d){var e=Qd(a.B,a.s,a.j,d);Array.prototype.push.apply(a.o,ae(e,a.i));a.b+=d*c;a.j+=d}}};function se(a,b,c,d,e){this.c=a;this.b=b;this.g=c;this.a=null;this.h=d;this.f=e}se.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
se.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=this.g.b,b=[];a.c&&(b=Ud(a.c,a.f||1,this.b.a||0));var c=0;a.b&&a.i?c=(a.i-1)*a.b:0<b.length&&(c=b[0].start-(a.g||0));var d=a.a.length;0<b.length&&b.length!=a.a.length&&(d=Math.min(b.length,a.a.length));for(var e=[],f=0;f<d;++f){var g=a.a[f],h=c/a.f,l=null,m=null;a.b?(l=c+a.b,m=l/a.f):0<b.length?(l=b[f].end-(a.g||0),m=l/a.f):(m=h+this.b.a,l=m*a.f);var c=l,l=0,n=null;g.a&&(l=g.a.na,n=g.a.end);e.push(new Sd(h,m,new H(this.f,
g.b,l,n)))}"dynamic"==this.c.type?this.a=new U(e,this.c,this.b,this.h):this.a=new S(e);return Promise.resolve(this.a)};function te(a,b,c,d,e){this.f=a;this.b=b;this.c=c;this.h=d;this.a=null;this.g=e}te.prototype.destroy=function(){this.g=this.c=this.b=this.f=null;this.a&&(this.a.destroy(),this.a=null)};
te.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.f.type)try{this.a=new qe(this.f,this.b,this.c,this.h,this.g)}catch(a){return Promise.reject(a)}else{var b;b=this.c.a;if(b=Qd(this.g,this.c,1,Math.ceil(this.b.a/(b.b/b.a)))){if(0<b.length){var c=b[b.length-1];b[b.length-1]=$d(c,c.b,this.b.a)}b=new S(b)}else b=null;this.a=b;if(!this.a)return b=Error("Failed to generate SegmentReferences"),b.type="stream",Promise.reject(b)}return Promise.resolve(this.a)};function ue(a,b,c,d,e){this.b=a;this.c=b;this.f=c;this.h=d;this.a=null;this.g=e}ue.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null)};
ue.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=this.f.a,b=Ud(a.c,a.a||1,this.c.a||0),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.a,g=b[d].end/a.a,e=Rd(this.g,this.f,d+a.j,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);var h=(a.i||0)/a.a;c.push(new Sd(f-h,g-h,e))}"dynamic"==this.b.type?this.a=new U(c,this.b,this.c,this.h):this.a=new S(c);return Promise.resolve(this.a)};function ve(){this.C=we++;this.id=this.D=this.H=null;this.c=0;this.height=this.width=this.bandwidth=null;this.b=this.a="";this.f=[];this.N=!1;this.K=!0}var we=0;ve.prototype.destroy=function(){this.H&&(this.H.destroy(),this.H=null);this.D&&(this.D.destroy(),this.D=null)};function xe(a){var b=a.a||"";a.b&&(b+='; codecs="'+a.b+'"');return b}function ye(){this.C=ze++;this.id=null;this.contentType=this.lang="";this.b=!1;this.m=[];this.a=[]}var ze=0;
ye.prototype.destroy=function(){for(var a=0;a<this.m.length;++a)this.m[a].destroy();this.a=this.m=null};function Ae(a){for(var b=[],c=0;c<a.a.length;++c){var d=new Be;d.id=a.C;d.a=a.a[c];d.contentType=a.contentType;d.b=a.m.length?xe(a.m[0]):"";b.push(d)}return b}function Ce(){this.id=null;this.start=0;this.b=null;this.a=[]}Ce.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function De(){this.b=!1;this.h=this.g=this.f=null;this.c=0;this.a=[]}
De.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function Be(){this.id=0;this.a=null;this.b=this.contentType=""};function Ee(a,b){Oa.call(this,"readwrite",b);this.j=a;this.b=0}q(Ee,Oa);
function Fe(a,b,c,d,e){for(var f=[],g=[],h=0,l=0,m=[],n=b.map(function(a){return a.H.create()}),n=Promise.all(n),t=b.map(function(a){return a.D.create()}),t=Promise.all(t),n=Promise.all([n,t]).then(function(a){f=a[0];g=a[1];h=f.reduce(function(a,b){return a+b.length()},0)}),t=0;t<b.length;++t)n=n.then(function(a){return Ge(this,b[a],f[a],g[a],h,l)}.bind(a,t)),n=n.then(function(a,b){l+=f[a].length();m.push(b)}.bind(a,t));return n.then(x(a,function(){return He(Va(this))})).then(x(a,function(a){var b=
new y;c=ra(c);var f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.a,license_server:e.h,with_credentials:e.i,distinctive_identifier:e.g,audio_robustness:e.f,video_robustness:e.j},g=Va(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}function Ie(a,b){return Wa(Va(a),b).then(x(a,function(a){var d=[],e;for(e in a.stream_ids)d.push(Je(this,a.stream_ids[e]));a=Va(this);d.push(a.delete(b));return Promise.all(d)}))}
function Ge(a,b,c,d,e,f){var g=[He(Ua(a)),He(Sa(a).index("stream"))],g=Promise.all(g).then(x(a,function(a){return{qa:Math.max(a[0],a[1]),ja:new ArrayBuffer(0),Ka:0,o:[],Da:null,$b:e,kb:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}function He(a){var b=new y,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}
Ee.prototype.g=function(a,b,c){var d=new y;a={stream_id:c.qa,mime_type:a.a,codecs:a.b,init_segment:b,references:c.o};var e=Ua(this).put(a);e.onsuccess=function(){d.resolve(c.qa)};e.onerror=function(){d.reject(e.error)};return d};Ee.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=d==a.length()-1,f=this.c.bind(this,e,b,f),c=c.then(this.i.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(x(this,function(a){Je(this,b.qa);return Promise.reject(a)}))};
Ee.prototype.c=function(a,b,c,d){var e=new y;0==b.ja.byteLength&&(b.Da=a);b.ja=Ke(b.ja,d);b.kb++;var f=E({type:"progress",detail:b.kb/b.$b*100,bubbles:!0});if(1048576<=b.ja.byteLength||c){c={stream_id:b.qa,segment_id:b.Ka,content:b.ja};var g=Sa(this).put(c);b.o.push({start_time:b.Da.b,start_byte:b.Da.url.f,end_time:a.a,url:"idb://"+b.qa+"/"+b.Ka});b.Ka++;b.ja=new ArrayBuffer(0);g.onerror=function(){e.reject(g.error)};g.onsuccess=x(this,function(){this.dispatchEvent(f);e.resolve()})}else this.dispatchEvent(f),
e.resolve();return e};function Ke(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}Ee.prototype.i=function(a){var b=new yb;b.c=1E3*this.b;return zb(a.url,b,this.j)};
function Je(a,b){var c=new y,d=Ua(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=Sa(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c};function Le(){}
Le.prototype.parse=function(a,b,c,d){var e=null;try{var f;var g=new ca(b);if(440786851!=r(g).id)f=null;else{var h=r(g);if(408125543!=h.id)f=null;else{var l=h.a.byteOffset,m;var n=new ca(h.a);for(b=null;eb(n.a);){var t=r(n);if(357149030==t.id){b=t;break}}if(b){for(var C=new ca(b.a),n=1E6;eb(C.a);){var u=r(C);if(2807729==u.id){n=ja(u);break}}m=n/1E9}else m=null;f=m?{Ub:l,Zb:m}:null}}if(f){var v=r(new ca(a));if(475249515!=v.id)e=null;else{var wa=f.Ub,Qb=f.Zb;a=[];var ee=new ca(v.a);for(f=v=-1;eb(ee.a);){var fe=
r(ee);if(187==fe.id){var Ia;var ge=new ca(fe.a),he=r(ge);if(179!=he.id)Ia=null;else{var If=ja(he),ie=r(ge);if(183!=ie.id)Ia=null;else{for(var je=new ca(ie.a),l=0;eb(je.a);){var ke=r(je);if(241==ke.id){l=ja(ke);break}}Ia={ac:If,Tb:l}}}if(Ia){var le=Qb*Ia.ac,me=wa+Ia.Tb;if(0<=v){var Uc=new H(d,c,f,me-1);a.push(new Sd(v,le,Uc))}v=le;f=me}}}0<=v&&(Uc=new H(d,c,f,null),a.push(new Sd(v,null,Uc)));e=a}}else e=null}catch(ne){if(!(ne instanceof RangeError))throw ne;}return e};function Me(a,b,c,d,e){D.call(this,a);this.b=b;this.a=new sb(c,d,e);this.w=this.I=this.c=null;this.J=!1;this.g=null;this.l=!1;this.i=null;this.s=!1;this.h=new y;this.j=this.f=!1;this.B=0;this.L=15;this.F=!1}q(Me,D);Me.prototype.G=function(a){null!=a.initialStreamBufferSize&&(this.B=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.L=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.s=Number(a.segmentRequestTimeout))};
Me.prototype.destroy=function(){Ne(this);this.h.destroy();this.c=this.h=null;this.a.destroy();this.v=this.b=this.a=null};k=Me.prototype;k.oa=function(){return this.c};k.cb=function(){return this.I};k.sb=function(a){this.f||a.then(function(){this.f=!0;this.g||Oe(this,0)}.bind(this)).catch(function(){});return this.h};k.Ha=function(){return this.j};
k.ra=function(a,b,c){if(a!=this.c){var d=[a.H.create(),a.D.create()];Promise.all(d).then(x(this,function(d){if(this.b){var f=this.c;this.c=a;this.I=d[0];this.w=d[1];this.J=!0;this.l||(f?b&&Pe(this,c):Oe(this,0))}})).catch(x(this,function(a){"aborted"!=a.type&&(this.f?(a=F(a),this.dispatchEvent(a)):this.h.reject(a))}))}};
function Pe(a,b){a.c&&!a.l&&(a.l=!0,Ne(a),ub(a.a).then(x(a,function(){if(b)return Db(this.a,this.b.currentTime+b);this.F=!0;return Cb(this.a)})).then(x(a,function(){this.l=!1;Oe(this,0)})).catch(x(a,function(a){this.l=!1;this.f?(a=F(a),this.dispatchEvent(a)):this.h.reject(a)})))}k.lb=function(a){return 0<vb(this.a,a)&&0<=Ab(this.a.b,a)};k.va=function(){};k.Ea=function(){return!0};
k.Ob=function(){if(this.s&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.j)a=1<this.a.c.buffered.length?!0:!1;if(a)Pe(this);else{this.g=null;a=this.c;var b=this.I,c=this.b.currentTime;Math.floor(c)==Math.floor(this.b.duration)?(this.b.currentTime=this.b.duration,this.b.pause()):vb(this.a,this.s?c:c+(this.i||0))>=(this.s?Math.max(this.B,this.L):this.B)?(Qe(this),Oe(this,1E3/(Math.abs(this.b.playbackRate)||1))):(b=Re(this,c,b))?(b=wb(this.a,b,a.c,this.w),this.w=null,this.J&&(this.J=!1,Se(this,a)),
this.j=!1,b.then(x(this,function(a){null==this.i&&(this.i=a);this.F&&0<vb(this.a,c)&&(this.F=!1,this.b.currentTime+=.001);Oe(this,0)})).catch(x(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.bc.status)&&this.c&&Oe(this,500);a=F(a);this.dispatchEvent(a)}}))):(Qe(this),this.f&&!this.j&&(this.j=!0,Te(this)),Oe(this,1E3))}}};function Re(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.a?c.la(a.a):null:c.la(b)||(c.length()?c.A():null)}
function Qe(a){if(!a.s&&null!=a.i){a.s=!0;var b=a.a,c=a.i,d=c-b.w;0!=d&&(b.b=ae(b.b,d),b.w=c);a.h.resolve(a.i)}}function Se(a,b){var c;c=b.a.split("/")[0];c=E({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function Te(a){var b=E({type:"ended"});a.dispatchEvent(b)}function Oe(a,b){a.g=window.setTimeout(a.Ob.bind(a),b)}function Ne(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function Ue(a,b){D.call(this,a);this.c=b;this.h=!0;this.i=this.g=null;this.f=new y;this.b=null}q(Ue,D);Ue.prototype.G=function(){};Ue.prototype.destroy=function(){this.b&&this.c.removeChild(this.b);this.f.destroy();this.v=this.c=this.g=this.i=this.b=this.f=null};k=Ue.prototype;k.oa=function(){return this.g};k.cb=function(){return this.i};k.sb=function(){return this.f};k.Ha=function(){return!0};
k.ra=function(a){a.H.create().then(x(this,function(b){if(this.c){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.g;this.g=a;this.i=b;b=T(b).url.b[0].toString();var d=this.Ea();this.b&&(this.va(!1),this.c.removeChild(this.b));this.b=document.createElement("track");this.c.appendChild(this.b);this.b.src=b;this.va(d);b=E({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.f.resolve(0)}}))};k.lb=function(){return!0};
k.va=function(a){this.h=a;this.b&&(this.b.track.mode=a?"showing":"disabled")};k.Ea=function(){this.b&&(this.h="showing"==this.b.track.mode);return this.h};function Ve(){}
Ve.prototype.parse=function(a,b,c,d){var e=null;try{a:{var f=[],g=new da(a),h=G(g);if(1936286840!=G(g))e=null;else{1==h&&(h=fb(g));var l=ia(g);w(g,3);w(g,4);var m=G(g);if(0==m)e=null;else{var n,t;0==l?(n=G(g),t=G(g)):(n=fb(g),t=fb(g));w(g,2);var C=g.b.getUint16(g.a,g.c);g.a+=2;a=n;b=b+h+t;for(h=0;h<C;h++){var u=G(g);t=(u&2147483648)>>>31;var l=u&2147483647,v=G(g);G(g);if(1==t){e=null;break a}var wa=new H(d,c,b,b+l-1);f.push(new Sd(a/m,(a+v)/m,wa));a+=v;b+=l}e=f}}}}catch(Qb){if(!(Qb instanceof RangeError))throw Qb;
}return e};function We(a,b,c,d,e,f,g){this.g=a;this.i=b;this.f=c;this.a=d;this.c=e;this.j=f;this.b=null;this.h=g}We.prototype.destroy=function(){this.h=this.i=this.g=null;this.a.g();this.a=null;this.c&&(this.c.g(),this.c=null);this.b=null};
We.prototype.create=function(){if(this.b)return this.b;var a=[zb(this.a)];"webm"==this.f&&a.push(zb(this.c));return this.b=Promise.all(a).then(x(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.f?(d=new Ve,d=d.parse(new DataView(c),this.a.f,this.a.b,this.h)):"webm"==this.f&&(d=new Le,d=d.parse(new DataView(c),new DataView(a),this.a.b,this.h));if(!d)return c=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),c.type="stream",Promise.reject(c);
var e;"dynamic"==this.g.type?e=new U(d,this.g,this.i,this.j):e=new S(d);return Promise.resolve(e)}))};function Xe(a,b,c){D.call(this,a);this.h=b;this.b=c;this.a=this.i=null;this.l=new A;this.c=[];this.f=[];this.s=0;this.g=new y;this.j=null;this.w=0}q(Xe,D);Xe.prototype.destroy=function(){this.v=null;for(var a=0;a<this.f.length;++a)this.f[a].close().catch(function(){});this.f=[];this.c=this.a=this.i=null;this.g.destroy();this.g=null;this.l.destroy();this.l=null;this.j&&(window.clearTimeout(this.j),this.j=null);this.h=this.b=null};
Xe.prototype.initialize=function(){for(var a=new z,b=this.b.bb(),c=0;c<b.length;++c){var d=b[c];d.a.a||d.b&&!Ye(d.b)||a.push(d.contentType,d)}for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.g?"required":"optional",persistentState:h.v||this.b.ha()?"required":"optional",sessionTypes:[this.b.ha()?"persistent-license":"temporary"]},
c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var l;"audio"==f.contentType?l=f.a.f:"video"==f.contentType&&(l=f.a.j);h[g].push({contentType:f.b,robustness:l})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return this.b.La(a),this.g.resolve(),Promise.resolve();l=new y;c=Ze(this,c,l);c=c.then(this.ub.bind(this,b,a));c=c.then(this.Vb.bind(this));l.reject(null);return c};
function $e(a,b){null==a.j&&(a.j=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.g.reject(a)}.bind(a),b));return a.g}function af(a){return Promise.all(a.f.map(function(a){return a.remove()}))}
function Ze(a,b,c){for(var d in b)c=c.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,d,b[d]));a.b.ha()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c}k=Xe.prototype;
k.ub=function(a,b,c){if(!this.h)return bf();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var l=e[h+"Capabilities"];if(l&&l.length){for(var l=l[0],m=[],n={},t=0;t<a.length;++t){var C=a[t];if(C.a.a==d&&C.b==l.contentType&&!(C.id in n)){m.push(C);n[C.id]=!0;var u;if(this.a){u=this.a;var C=C.a,v=new Pb;v.a=u.a;v.h=u.h;v.i=u.i;v.l=u.l;v.s=u.s;v.g=u.g;v.v=u.v;v.f=u.f;v.j=u.j;v.c=u.c?new Uint8Array(u.c.buffer):null;Sb(v,u.b);Sb(v,
C.b);u=v}else u=C.a;this.a=u}}b.set(h,m)}}}this.b.La(b);return c.createMediaKeys()};
k.Vb=function(a){if(!this.h)return bf();this.i=a;return this.h.setMediaKeys(this.i).then(x(this,function(){return this.h?this.a.c?this.i.setServerCertificate(this.a.c):Promise.resolve():bf()})).then(x(this,function(){if(!this.h)return bf();if(0<this.b.ua().length)cf(this);else{for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.eb({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&B(this.l,this.h,"encrypted",this.eb.bind(this))}}))};
function bf(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}
k.eb=function(a){for(var b=new Uint8Array(a.initData),c=0;c<this.c.length;++c)if(ga(b,this.c[c].data))return;try{var d=df(this)}catch(e){b=F(e);this.dispatchEvent(b);this.g.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.c.push({data:b,Ma:d});a.catch(x(this,function(a){if(this.h){for(var b=0;b<this.c.length;++b)if(this.c[b].Ma==d){this.c.splice(b,1);break}b=F(a);this.dispatchEvent(b);this.g.reject(a)}}));this.f.push(d)};
function cf(a){for(var b=a.b.ua(),c=0;c<b.length;++c){var d=df(a),e=d.load(b[c]);a.f.push(d);e.then(x(a,function(){this.s++;this.s>=this.f.length&&this.g.resolve()})).catch(x(a,function(a){a=F(a);this.dispatchEvent(a)}))}}
function df(a){var b=null;if(a.b.ha())try{b=a.i.createSession("persistent-license")}catch(c){throw Error("Persistent licenses are not supported by this key system or platform.");}else b=a.i.createSession();B(a.l,b,"message",a.Kb.bind(a));B(a.l,b,"keystatuseschange",a.zb.bind(a));return b}k.Kb=function(a){ef(this,a.target,this.a,a.message)};
k.zb=function(a){a=a.target;for(var b=a.keyStatuses,c={},d=b.keys(),e=d.next();!e.done;e=d.next()){var f=qa(new Uint8Array(e.value)),e=b.get(e.value);c[f]=e}if(a.expiration<Date.now()){for(b=0;b<this.c.length;++b)if(this.c[b].Ma==a){this.c.splice(b,1);break}a.close();this.f.splice(this.f.indexOf(a),1)}this.b.fb(c)};
function ef(a,b,c,d){d=ff(c,d);Yd(new Xd(d.url,d.body,d.method,c.i,d.headers,a.w)).then(x(a,function(a){c.l&&(a=c.l(a));return b.update(a)})).then(x(a,function(){var a=E({type:"sessionReady",detail:b});this.dispatchEvent(a);this.s++;this.s>=this.f.length&&this.g.resolve()})).catch(x(a,function(a){a.Ma=b;a=F(a);this.dispatchEvent(a)}))}
function ff(a,b){var c={url:a.h,body:b.slice(0),method:"POST",headers:{}};if("com.microsoft.playready"===a.a){for(var d=String.fromCharCode.apply(null,new Uint16Array(c.body)),d=(new DOMParser).parseFromString(d,"application/xml"),e=d.getElementsByTagName("name"),f=d.getElementsByTagName("value"),g=0;g<e.length;g++)c.headers[e[g].childNodes[0].nodeValue]=f[g].childNodes[0].nodeValue;c.body=window.atob(d.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue)}if(!a.s)return c;a.s(c);c.url=Aa(c,
"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=Aa(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=Ba(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");return c};function gf(a){this.b=a;this.a=null}gf.prototype.destroy=function(){this.b=null;this.a&&(this.a.destroy(),this.a=null)};gf.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=[],b=0;b<this.b.length;++b){var c=this.b[b];a.push(new Sd(c.start_time,c.end_time,new H(null,[new K(c.url)],c.start_byte,null)))}this.b=null;this.a=new S(a);return Promise.resolve(this.a)};function hf(a){this.b=a;this.a=null}hf.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)};hf.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new Sd(0,null,this.b);this.a=new S([a]);return Promise.resolve(this.a)};function jf(a){this.a=a}
function kf(a,b,c){for(var d=ka()/1E3,e=0;e<b.a.length;++e)for(var f=b.a[e],g=0;g<f.b.length;++g){var h=f.b[g];if("text"!=h.contentType)for(var l=0;l<h.a.length;++l){var m=h.a[l],n=0,n=n+(m.g?1:0),n=n+(m.b?1:0),n=n+(m.a?1:0);0==n?(h.a.splice(l,1),--l):1!=n&&(m.g?(m.b=null,m.a=null):m.b&&(m.a=null))}}lf(b);for(e=0;e<b.a.length;++e)for(f=b.a[e],g=0;g<f.b.length;++g){l=h=f.b[g];m=null;for(n=0;n<l.a.length;++n){var t=l.a[n].f||"";m?t!=m&&(l.a.splice(n,1),--n):m=t}0==h.a.length&&(f.b.splice(g,1),--g)}"dynamic"==
b.type&&null==b.c&&(b.c=d);e=new De;"dynamic"==b.type&&(e.b=!0,e.f=b.g,e.g=new H(c,b.j||b.url),e.h=b.c);e.c=b.h||5;for(f=0;f<b.a.length;++f){g=b.a[f];if(null==g.start)break;g=mf(a,b,g,d,c);e.a.push(g)}return e}
function lf(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.b=null);b(a.b)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.b);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.b};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.b)||(e=a.a[a.a.length-1],d?a.b=c:b(e.start)&&b(e.a)?a.b=e.start+e.a:"dynamic"!=a.type&&
(a.b=c))}}function mf(a,b,c,d,e){var f=new Ce;f.id=c.id;f.start=c.start;f.b=c.a;var g=new z;c.b.forEach(function(a){g.push(a.contentType||"",a)});for(var h=ua(g),l=0;l<h.length;++l){var m=new z;g.get(h[l]).forEach(function(a){m.push(a.group,a)});for(var n=ua(m),t=0;t<n.length;++t){var C=new z;m.get(n[t]).forEach(function(a){C.push(a.lang,a)});for(var u=ua(C),v=0;v<u.length;++v){var wa=C.get(u[v]),wa=nf(a,b,c,wa,d,e);f.a.push(wa)}}}return f}
function nf(a,b,c,d,e,f){Ca(d.every(function(a){return a.group==d[0].group&&(a.lang||"")==(d[0].lang||"")&&(a.contentType||"")==(d[0].contentType||"")}));var g=new ye,h=d.filter(function(a){return null!=a.id});h.length==d.length&&(g.id=h.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));g.lang=d[0].lang||"";g.contentType=d[0].contentType||"";g.b=d.some(function(a){return a.c});for(var h={},l=0;l<d.length;++l)for(var m=d[l],n=0;n<m.a.length;++n){var t=m.a[n],C=of(a,t),u=g.a.slice(0);
pf(C,u);0==u.length&&0<g.a.length||!(t=qf(b,c,t,e,f))||(g.m.push(t),g.a=u,h[t.C]=m)}if(g.a.some(function(a){return""==a.a}))return g.m.forEach(function(a){a.N=!0}),g;a=rf(d);for(l=0;l<g.m.length;++l)t=g.m[l],m=h[t.C],m==a&&(t.N=!0);return g}function rf(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function pf(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.h==g.h&&f.i==g.i&&f.g==g.g&&f.v==g.v&&f.f==g.f&&f.j==g.j&&ga(f.c,g.c)){d=!0;Sb(b[c],a[e].b);break}}d||(b.splice(c,1),--c)}}function of(a,b){var c=[];if(0==b.c.length)c.push(new Pb);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,sf(a,b.c[d]));return c}
function sf(a,b){var c=[];if(2!=a.a.length)return[];var d=a.a(b.c||"",b.f);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f=Rb(d[e]);0==f.b.length&&b.a&&b.a.psshBox&&Sb(f,[{initData:b.a.psshBox,initDataType:"cenc"}]);c.push(f)}return c}
function qf(a,b,c,d,e){if(!c.u||0===c.u.length)return null;var f=null,g=1,h=0;if(c.g)f=c.f.split("/")[1],"mp4"!=f&&"webm"!=f?f=null:(g=c.g,"webm"!=f||g.c?g.a||g.b&&g.b.a?(h=g.b,h||(h=new pd,h.url=c.u,h.a=g.a?g.a.clone():null),h=tf(h,e),g=g.c?tf(g.c,e):null,a=new We(a,b,f,h,g,d,e),b=new Zd(g),d=new ve,d.H=a,d.D=b,f=d):f=null:f=null),g=c.g.g,h=c.g.f;else if(c.b)f=c.b,!f.b&&!f.c&&1<f.a.length?f=null:f.b||b.a||f.c||1!=f.a.length?f.c&&0===f.c.a.length?f=null:(f=f.h?tf(f.h,e):null,a=new se(a,b,c,d,e),b=
new Zd(f),d=new ve,d.H=a,d.D=b,f=d):f=null,g=c.b.f,h=c.b.g;else if(c.a){a:if(f=c.a,g=0+(f.f?1:0),g+=f.c?1:0,g+=f.b?1:0,0==g?g=!1:(1!=g&&(f.f?(f.c=null,f.b=null):f.c&&(f.b=null)),g=!0),g){g=null;if(f.g&&(g=(f=c.a.g)?uf(c,f,qd):null,!g)){f=null;break a}f=g?tf(g,e):null;g=c.a;g.f?(g=c.f.split("/")[1],"mp4"!=g&&"webm"!=g?a=null:"webm"!=g||f?Rd(e,c,1,0)?(h=(h=c.a.f)?uf(c,h,pd):null)?(h=tf(h,e),a=new We(a,b,g,h,f,d,e)):a=null:a=null:a=null):a=g.h?g.c?new ue(a,b,c,d,e):g.b?"dynamic"!=a.type&&null==b.a?null:
new te(a,b,c,d,e):null:null;a?(b=new Zd(f),d=new ve,d.H=a,d.D=b,f=d):f=null}else f=null;g=c.a.a;h=c.a.i}else"text"==c.f.split("/")[0]&&(f=new ve,f.H=new hf(new H(e,c.u)));if(!f)return null;f.id=c.id;h&&(f.c=-1*h/g);f.bandwidth=c.bandwidth;f.width=c.width;f.height=c.height;f.a=c.f||"";f.b=c.h||"";for(a=0;a<c.c.length;++a)b=c.c[a],b.b&&f.f.push(b.b);return f}function uf(a,b,c){b=Td(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=Od(a.u,b);return c}
function tf(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.na,e=a.a.end);return new H(b,c,d,e)};function vf(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function wf(a,b){var c=new xf(b);a.streamHistory.push(new yf(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function xf(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function yf(a){this.timestamp=ka()/1E3;this.value=a};function V(a){D.call(this,null);this.a=a;this.b=null;this.f=new A;this.i=this.j=null;this.F=0;this.w=null;this.h=!1;this.g=new vf;this.c={enableAdaptation:!0,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new Ub};this.s=1;this.G=null}q(V,D);p("shaka.player.Player",V);V.version="v1.6.3-1-g317b83e-dirty";
V.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function Ye(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}V.isTypeSupported=Ye;
V.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+Jb(a)+" }",0)};V.prototype.destroy=function(){return this.l().then(x(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};V.prototype.destroy=V.prototype.destroy;
V.prototype.l=function(){if(!this.b)return Promise.resolve();this.h&&zf(this);this.a.pause();Fa(this.f);Af(this);Bf(this);this.j&&(this.j.destroy(),this.j=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.h=!1;this.g=new vf;return a};V.prototype.unload=V.prototype.l;
V.prototype.J=function(a){var b=this.l();this.a.autoplay&&(nb("load"),B(this.f,this.a,"timeupdate",this.yb.bind(this)));a.T(this.c);a.pb(this.G);this.G=null;b=b.then(x(this,function(){return a.X()}));b.catch(x(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(x(this,function(){if(!this.a)return Cf();this.b=a;B(this.f,this.b,"seekrangechanged",this.Ib.bind(this));this.j=new Xe(this,this.a,this.b);return this.j.initialize()})).then(x(this,function(){if(!this.a)return Cf();B(this.f,
this.a,"error",this.Wb.bind(this));B(this.f,this.a,"playing",this.Gb.bind(this));B(this.f,this.a,"pause",this.Fb.bind(this));return this.b.Wa(this,this.a)})).then(x(this,function(){if(!this.a)return Cf();Df(this)})).catch(x(this,function(a){if(!this.a)return Cf();if("destroy"!=a.type){var b=F(a);this.dispatchEvent(b)}return this.l().then(function(){return Promise.reject(a)})}))};V.prototype.load=V.prototype.J;
function Cf(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}k=V.prototype;k.yb=function(){qb("load");this.g.playbackLatency=rb("load")/1E3;this.f.sa(this.a,"timeupdate")};k.Wb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(Ef[a]||"Unknown playback error."),a.type="playback",a=F(a),this.dispatchEvent(a))}};
k.Gb=function(){nb("playing");!this.i&&0>this.s&&(this.a.playbackRate=0,this.B(this.a.currentTime,Date.now(),this.s));this.h&&zf(this)};k.Fb=function(){qb("playing");var a=rb("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}Bf(this)};k.Ib=function(a){this.F=a.start};
k.qb=function(){if(!this.a.paused){qb("playing");var a=rb("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;nb("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};V.prototype.getStats=V.prototype.qb;V.prototype.ea=function(){return this.b?this.b.ma():[]};V.prototype.getVideoTracks=V.prototype.ea;V.prototype.Z=function(){return this.b?this.b.pa():[]};
V.prototype.getAudioTracks=V.prototype.Z;V.prototype.da=function(){return this.b?this.b.Pa():[]};V.prototype.getTextTracks=V.prototype.da;V.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};V.prototype.selectVideoTrack=V.prototype.selectVideoTrack;V.prototype.M=function(a,b,c){return this.b?this.b.nb(a,void 0==b?!0:b,c):!1};V.prototype.selectAudioTrack=V.prototype.M;V.prototype.fa=function(a){return this.b?this.b.ob(a,!1):!1};
V.prototype.selectTextTrack=V.prototype.fa;V.prototype.Y=function(a){this.b&&this.b.Oa(a)};V.prototype.enableTextTrack=V.prototype.Y;V.prototype.U=function(a){Bf(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.B(this.a.currentTime,Date.now(),a));this.s=a};V.prototype.setPlaybackRate=V.prototype.U;V.prototype.L=function(){return this.s};V.prototype.getPlaybackRate=V.prototype.L;V.prototype.R=function(a){this.G=a};V.prototype.setPlaybackStartTime=V.prototype.R;
V.prototype.I=function(){return this.b?this.b.mb():!1};V.prototype.isLive=V.prototype.I;
V.prototype.V=function(a){if(a){var b=xa(a,"enableAdaptation");null!=b&&(this.c.enableAdaptation=b);b=za(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=za(a,"liveStreamEndTimeout");null!=b&&(this.c.liveStreamEndTimeout=b);b=za(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=za(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=za(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=Aa(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=
b);b=Ba(a,"restrictions",Ub);null!=b&&(this.c.restrictions=b.clone());a=xa(a,"disableCacheBustingEvenThoughItMayAffectBandwidthEstimation");null!=a&&(Id=!a);this.b&&this.b.T(this.c)}};V.prototype.configure=V.prototype.V;V.prototype.$=function(){return this.c};V.prototype.getConfiguration=V.prototype.$;function Bf(a){a.i&&(window.clearTimeout(a.i),a.i=null)}function Df(a){Af(a);a.w=window.setTimeout(a.T.bind(a),100)}function Af(a){a.w&&(window.clearTimeout(a.w),a.w=null)}
V.prototype.B=function(a,b,c){this.i=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.F+(this.I()?1:.05)?this.a.pause():(d=Math.max(this.F,a+d),this.a.currentTime=d,this.i=window.setTimeout(this.B.bind(this,a,b,c),250))};function zf(a){qb("buffering");var b=a.g;b.bufferingTime+=rb("buffering")/1E3;a.h=!1;a.dispatchEvent(E({type:"bufferingEnd"}))}
V.prototype.T=function(){Df(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0),c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;if(this.h){if(c=this.b.ab(),b||a>c)zf(this),this.a.play()}else!this.a.paused&&!b&&.5>a&&(this.h=!0,this.a.pause(),this.g.bufferingHistory.push(ka()/1E3),nb("buffering"),this.dispatchEvent(E({type:"bufferingStart"})))}};
var Ef={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function Ff(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.m.length;++g)Ye(xe(f.m[g]))||(f.m.splice(g,1),--g);0==e.m.length&&(c.a.splice(d,1),--d)}}function Gf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d)c.a[d].m.sort(Hf)}function Hf(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};var Jf=!1;function Kf(a){this.a=a;this.b=!1}Kf.prototype.destroy=function(){this.a.destroy();this.a=null};Kf.prototype.update=function(a){var b=Lf(a),c=Lf(this.a);return Promise.all([b,c]).then(x(this,function(b){var c=b[0];b=b[1];var f=this.a.a;Ff(f);Gf(f);a.f=this.a.f;a.g=this.a.g?this.a.g.clone():null;a.c=this.a.c;f=[];Mf(a,this.a,c,b,f);c=a.a;Ff(c);Gf(c);this.b=Jf;Jf=!1;return Promise.resolve(f)}))};
function Lf(a){function b(a,b){return a.concat(b)}var c=a.a.map(function(a){return a.a}).reduce(b,[]).map(function(a){return a.m}).reduce(b,[]);a=c.map(function(a){return a.H.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].C]=a[f];return Promise.resolve(b)})}
function Mf(a,b,c,d,e){var f=new z;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new z;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=ua(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(Nf(l[0],h[0],c,d,e),l[0].b=h[0].b)}}
function Nf(a,b,c,d,e){var f=new z;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new z;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=ua(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&Of(l[0],h[0],c,d,e)}}
function Of(a,b,c,d,e){var f=new z;a.m.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new z;b.m.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=ua(f),l=0;l<h.length;++l){var m=h[l];b[m]=m;var n=f.get(m);if(!(1<n.length))if((m=g.get(m))&&0!=m.length){if(1==m.length){Pf(n[0],m[0],c,d);n[0].D=m[0].D;m[0].D=null;if(n[0].width!=m[0].width||n[0].height!=m[0].height)Jf=!0,n[0].width=m[0].width,n[0].height=m[0].height;n[0].c=m[0].c}}else e.push(n[0]),a.m.splice(a.m.indexOf(n[0]),1)}h=ua(g);
for(l=0;l<h.length;++l)m=h[l],b[m]||(b[m]=m,m=g.get(m),a.m.push(m[0]))}function Pf(a,b,c,d){a=c[a.C];b=d[b.C];a.length();a.Ia(b)&&a.length()};function W(){this.a=this.b=null;this.f=new A;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}p("shaka.media.SimpleAbrManager",W);W.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};W.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
W.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,B(this.f,this.b,"bandwidth",this.v.bind(this)),B(this.f,this.a,"adaptation",this.j.bind(this)),B(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};W.prototype.enable=function(a){this.i=a};W.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=Qf(this);return a?a.id:null};W.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
W.prototype.v=function(){Date.now()<this.c||this.h()};W.prototype.h=function(){if(this.i){var a=Qf(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};W.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function Qf(a){var b=a.a.ma();if(0==b.length)return null;b.sort(Mb);var c;a:{c=a.a.pa();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function Rf(a,b,c){D.call(this,null);this.f=a;this.c=b;this.b=Rb(c);this.a=null}q(Rf,D);p("shaka.player.HttpVideoSource",Rf);Rf.prototype.T=function(){};Rf.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null);this.v=this.b=null};k=Rf.prototype;k.Wa=function(a,b){this.v=a;var c=b.mediaKeys;b.src=this.f;c=b.setMediaKeys(c);this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing");return c};k.X=function(){return Promise.resolve()};
k.ma=function(){return[]};k.pa=function(){return[]};k.Pa=function(){return[]};k.ab=function(){return 5};k.bb=function(){var a=new Be;a.a=this.b;return[a]};k.La=function(){};Rf.prototype.selectVideoTrack=function(){return!1};k=Rf.prototype;k.nb=function(){return!1};k.ob=function(){return!1};k.Oa=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")};k.pb=function(){};k.ua=function(){return[]};k.ha=function(){return!1};k.mb=function(){return!1};
k.fb=function(a){for(var b in a){var c=a[b],d=ba[c]||null;if(d){var e=ma(b),d=Error("Key "+e+" is not usable. "+d);d.type="drm";d.code=c;c=F(d);this.dispatchEvent(c)}}};function X(a,b,c,d,e){D.call(this,null);this.tb=e;this.a=a;this.Z=b;this.i=new A;this.g=new MediaSource;this.f=null;this.da=0;this.b=new z;this.I=c;this.I.initialize(b,this);this.L=!1;this.J="en";this.fa=!1;this.U=null;this.B=new y;this.h=new Ub;this.F=null;this.Va=1;this.c={};this.ea=new y;this.Ua=0;this.w=null;this.Sa=this.Ta=!1;this.s={};this.$=this.Y=this.V=null;this.G={};this.za=d}q(X,D);p("shaka.player.StreamVideoSource",X);
X.prototype.T=function(a){null!=a.streamBufferSize&&(this.G.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.G.segmentRequestTimeout=a.segmentRequestTimeout);Sf(this);null!=a.enableAdaptation&&this.I.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.da=Number(a.mpdRequestTimeout));null!=a.preferredLanguage&&(this.J=Ja(String(a.preferredLanguage)));null!=a.restrictions&&(this.h=a.restrictions,this.L&&Tf(this))};
X.prototype.destroy=function(){this.B.destroy();this.ea.destroy();this.ea=this.B=null;this.Y&&(window.clearTimeout(this.Y),this.Y=null);this.V&&(window.clearTimeout(this.V),this.V=null);this.s=null;this.i.destroy();this.i=null;va(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.I.destroy();this.v=this.h=this.U=this.f=this.g=this.Z=this.I=null};k=X.prototype;
k.Wa=function(a,b){if(!this.L){var c=Error("Cannot call attach() right now.");c.type="app";return Promise.reject(c)}this.v=a;this.f=b;this.U=a.qb();B(this.i,this.g,"sourceopen",this.Bb.bind(this));B(this.i,this.Z,"bandwidth",this.Xb.bind(this));this.a.b&&(B(this.i,a,"bufferingStart",this.xb.bind(this)),B(this.i,a,"bufferingEnd",this.wb.bind(this)));c=this.f.mediaKeys;this.f.src=window.URL.createObjectURL(this.g);c=this.f.setMediaKeys(c);return Promise.all([this.B,c])};
k.X=function(){if(this.L){var a=Error("Cannot call load() right now.");a.type="app";return Promise.reject(a)}if(!this.a||0==this.a.a.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.a;Ff(a);Gf(a);if(0==this.a.a.length||0==this.a.a[0].a.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.L=!0;this.G.initialStreamBufferSize=this.a.c;Sf(this);Tf(this);
return Promise.resolve()};
k.ib=function(a){var b=Date.now(),c=this.V=null,d=this.a.g;(a?this.gb():this.hb(d)).then(x(this,function(a){c=new Kf(a);return c.update(this.a)})).then(x(this,function(a){if(1==c.b){var d=new bb;this.za.l();d=new Y(this.tb,null,d,null,this.za);this.za.J(d)}c.destroy();c=null;for(d=0;d<a.length;++d)Uf(this,a[d]);this.G.initialStreamBufferSize=this.a.c;Sf(this);Tf(this);0==Object.keys(this.c).length?Vf(this):Wf(this,(Date.now()-b)/1E3)})).catch(x(this,function(a){c&&(c.destroy(),c=null);"aborted"!=
a.type&&(a=F(a),this.dispatchEvent(a),this.a&&Wf(this,0))}))};k.hb=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};k.gb=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};function Wf(a,b){if(null!=a.a.f){var c=Math.max(a.a.f,3),c=Math.max(c-b,0);a.V=window.setTimeout(a.ib.bind(a,!1),1E3*c)}}
function Uf(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.oa()==b){var e=a.b.get(b.a.split("/")[0]).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.N&&a.K});if(0==e.length){c=Error("All usable streams have been removed from the manifest.");c.type="app";c=F(c);a.dispatchEvent(c);return}a.s[c].Qa==b&&delete a.s[c];d.ra(e[0],!0);b.destroy()}b.destroy()}
k.ma=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.oa():null)?a.C:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.m.length;++f){var g=e.m[f];if(g.N&&g.K){var h=g.C,g=new Lb(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};X.prototype.getVideoTracks=X.prototype.ma;
X.prototype.pa=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.oa():null)?a.C:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.m.length;++g){var h=e.m[g];if(h.N&&h.K){var l=h.C,h=new Nb(l,h.bandwidth,f);l==a&&(h.active=!0);b.push(h)}}return b};X.prototype.getAudioTracks=X.prototype.pa;
X.prototype.Pa=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.oa():null,b=b?b.C:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.m.length;++h){var l=f.m[h].C,m=new Ob(l,g);l==b&&(m.active=!0,m.enabled=a.Ea());c.push(m)}return c};X.prototype.getTextTracks=X.prototype.Pa;X.prototype.ab=function(){return Number(this.G.initialStreamBufferSize)};
X.prototype.bb=function(){var a;if(this.L){a=this.a.a[0];for(var b=[],c=0;c<a.a.length;++c)b.push.apply(b,Ae(a.a[c]));a=b}else a=[];return a};
X.prototype.La=function(a){if(this.L){for(var b={},c=this.a.a[0],d=0;d<c.a.length;++d){var e=c.a[d];b[e.C]=e}this.b.a={};c=ua(a);for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.b.push(e,b[g])}else if("audio"==e)for(var g=f[0].b.split(";")[0],h=0;h<f.length;++h){var l=f[h];l.b.split(";")[0]==g&&this.b.push(e,b[l.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.b.push(e,b[g])}this.fa=!0;if(a=this.b.get("audio"))Xf(this,a),this.b.set("audio",a),a=a[0].lang||this.J,Ha(2,
this.J,a)&&(this.fa=!1);if(a=this.b.get("text"))Xf(this,a),this.b.set("text",a),a=a[0].lang||this.J,Ha(2,this.J,a)||(this.fa=!1)}};X.prototype.selectVideoTrack=function(a,b,c){return Yf(this,"video",a,b,c)};k=X.prototype;k.nb=function(a,b,c){return Yf(this,"audio",a,b,c)};k.ob=function(a,b){return Yf(this,"text",a,b)};k.Oa=function(a){var b=this.c.text;b&&b.va(a)};k.pb=function(a){this.$=a};
function Tf(a){if(a.h){for(var b=!1,c=0;c<a.a.a.length;++c)for(var d=a.a.a[c],e=0;e<d.a.length;++e){var f=d.a[e];if("video"==f.contentType)for(var g=0;g<f.m.length;++g){var h=f.m[g],l=h.K;h.K=!0;a.h.maxWidth&&h.width>a.h.maxWidth&&(h.K=!1);a.h.maxHeight&&h.height>a.h.maxHeight&&(h.K=!1);a.h.minHeight&&h.height<a.h.minHeight&&(h.K=!1);a.h.maxBandwidth&&h.bandwidth>a.h.maxBandwidth&&(h.K=!1);a.h.minBandwidth&&h.bandwidth<a.h.minBandwidth&&(h.K=!1);l!=h.K&&(b=!0)}}0!=sa(a.b).length&&b&&(Zf(a),0<a.ma().length||
(b=Error("The application has restricted all video tracks!"),b.type="app",b=F(b),a.dispatchEvent(b)))}}k.ua=function(){return[]};k.ha=function(){return!1};k.mb=function(){return this.a?this.a.b:!1};
k.fb=function(a){for(var b,c=!1,d=new z,e=sa(this.b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.m.length;++h){var l=g.m[h];l.f.forEach(function(a){d.push(a,l)})}for(b in a)if(e=ba[a[b]]||null,g=d.get(b))for(f=0;f<g.length;++f)l=g[f],h=l.N,l.N=!e,h!=l.N&&(c=!0);else ma(b);c&&(Zf(this),b=this.pa(),a=this.ma(),b=this.b.a.hasOwnProperty("audio")&&0==b.length,a=this.b.a.hasOwnProperty("video")&&0==a.length,b||a)&&(a=Error("The key system has restricted all "+(b&&a?"audio and video tracks.":b?"audio tracks.":
"video tracks.")),a.type="drm",a=F(a),this.dispatchEvent(a))};function Zf(a){var b=E({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}function Yf(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],l=0;l<h.m.length;++l){var m=h.m[l];if(m.C==c){if(!m.N||!m.K)return!1;if("text"!=b&&!a.Sa)return c=a.s[b],a.s[b]={Qa:m,Xa:null!=c&&c.Xa||d,Ya:null!=c&&c.Ya||e},!0;wf(a.U,m);a.c[b].ra(m,d,e);return!0}}return!1}
function Xf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(Ha(c,a.J,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}k.Bb=function(){this.i.sa(this.g,"sourceopen");Vf(this).then(x(this,function(){this.B&&this.B.resolve()})).catch(x(this,function(a){this.B&&this.B.reject(a)}))};
function Vf(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=$f(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=va(f).map(function(a){return a.H.create()});return Promise.all(b).then(x(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=ag(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!bg(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.I.start();cg(this,f,a);return Promise.resolve()})).catch(x(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.b?(ka()<this.a.h?(a=Math.max(this.a.h-Date.now()/1E3,3),this.V=window.setTimeout(this.ib.bind(this,
!0),1E3*a)):Wf(this,0),Promise.resolve()):Promise.reject(a)}))}function $f(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.I.getInitialVideoTrackId();if(null==g)continue;f=e.m.filter(function(a){return a.C==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.m.filter(function(a){return a.N&&a.K});if(0==f.length)continue;f=e.m[Math.floor(f.length/2)]}else 0<e.m.length&&(f=e.m[0]);c[e.contentType]=f}return c}
function bg(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new Ue(a,a.f):dg(a,e);if(!e)return va(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function dg(a,b){var c=new Me(a,a.f,a.g,xe(b),a.Z);c.G(a.G);return c}
function cg(a,b,c){a.Va=a.f.playbackRate;a.f.playbackRate=0;eg(a,c);var d;a.$&&a.$<=c.end&&a.$>=c.start?d=a.$:a.a.b?(d=c.end,a.Ta=!0):d=c.start;B(a.i,a.f,"seeking",a.Jb.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.F=d);fg(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.sb(a.ea));B(a.i,d,"ended",a.Lb.bind(a));var f=b[e];wf(a.U,f);d.ra(f,!1)}Promise.all(c).then(a.vb.bind(a)).catch(x(a,function(a){"destroy"!=a.type&&(a=F(a),this.dispatchEvent(a))}));a.Oa(a.fa)}
k.vb=function(a){Ca(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=gg(this);for(d=0;d<a.length;++d)a[d].ka(c);hg(this,a,c);d=sa(this.b).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.H.create()];a.D&&b.push(a.D.create());return Promise.all(b)});Promise.all(d).then(x(this,function(a){for(var b=0;b<a.length;++b)a[b][0].ka(c);this.Sa=
!0;for(var d in this.s)a=this.s[d],b=this.c[d],wf(this.U,a.Qa),b.ra(a.Qa,a.Xa,a.Ya);this.s={}})).catch(x(this,function(a){"aborted"!=a.type&&(a=F(a),this.dispatchEvent(a))}))};function hg(a,b,c){if(b=ag(a,b))eg(a,b),fg(a,b.start,b.end);0!=c&&(c=a.f.currentTime+c,a.f.currentTime=c,a.F=c);a.Ta&&b&&(a.f.currentTime=b.end);a.f.playbackRate=a.Va;a.a.b&&null!=a.a.f&&Wf(a,0);ig(a);a.ea.resolve()}
function eg(a,b){if(a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}k.Nb=function(){this.Y=null;ig(this);var a=ag(this,gg(this));a&&(this.a.b&&this.Ua!=a.A&&(this.Ua=a.A,null!=this.w&&(window.clearTimeout(this.w),this.w=null)),fg(this,a.start,a.end),this.f.paused||jg(this,this.f.currentTime,a.start,a.end))};
function fg(a,b,c){b=E({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}k.Jb=function(){var a=this.f.currentTime;if(null!=this.F){if(a>=this.F-.01&&a<=this.F+.01){this.F=null;return}this.F=null}var b=ag(this,gg(this));if(b){var c=b.end;(b=jg(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.c)c=this.c[d].a.c.buffered,c=0<c.length?c.end(0):-1,0>c-a&&(this.f.currentTime=c)}};
function jg(a,b,c,d){if(b>=c-.01)return!1;b=0;if(a.a.b){b=.5;for(var e in a.c)if(!a.c[e].lb(c+b)){b=a.a.c;break}}a.f.currentTime=Math.min(c+b,d);return!0}k.Lb=function(){if(!this.a.b){for(var a in this.c)if(!this.c[a].Ha())return;this.$a()}};k.xb=function(){va(this.c).every(function(a){return a.Ha()})&&(this.w=window.setTimeout(this.$a.bind(this),432E5))};k.wb=function(){null!=this.w&&(window.clearTimeout(this.w),this.w=null)};
k.Xb=function(){var a=this.U,b=this.Z.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new yf(b))};k.$a=function(){this.w=null;this.g.endOfStream()};function gg(a){return va(a.c).map(function(a){return a.cb()}).filter(function(a){return null!=a})}
function ag(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,f=0;f<b.length;++f){var g=b[f].Fa(),c=Math.max(c,g.start);null!=g.end&&(d=Math.min(d,g.end));b[f].length()&&(e=Math.min(e,b[f].A().a))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.a[0],d.b)d=(d.start||0)+d.b;else return null;a.a.b&&(d=Math.max(d-a.a.c,c));return c>d?null:{start:c,end:d,A:e}}function ig(a){a.a.b&&(a.Y=window.setTimeout(a.Nb.bind(a),1E3))}function Sf(a){for(var b in a.c)a.c[b].G(a.G)};function Y(a,b,c,d,e){c||(c=new bb);d||(d=new W);X.call(this,null,c,d,e,a);this.Aa=a;this.l=null;this.M=b;this.R=[];this.ga=[];this.ta=[];this.j=null}q(Y,X);p("shaka.player.DashVideoSource",Y);Y.prototype.xa=function(a,b,c){this.R.push(a);this.ga.push(b||"");this.ta.push(c||"")};Y.prototype.addExternalCaptions=Y.prototype.xa;Y.prototype.Ba=function(a){this.j=a};Y.prototype.setNetworkCallback=Y.prototype.Ba;Y.prototype.destroy=function(){this.l=this.j=this.M=null;X.prototype.destroy.call(this)};
Y.prototype.X=function(){var a=new H(this.j,[new K(this.Aa)]);return Wd(new Vd(a,this.da)).then(x(this,function(a){this.l=a;for(var c=0;c<this.R.length;c++){var d=a,e=this.R[c],f=this.ga[c],g=this.ta[c];if(0!==d.a.length){var h=new fd;h.contentType="text";h.lang=f||"en";h.c=!0;f=new id;f.bandwidth=0;f.f=g||"text/vtt";f.u=[new K(e)];h.a.push(f);d.a[0].b.push(h);Bd(d.a[0])}}this.a=kf(new jf(this.M),a,this.j);return X.prototype.X.call(this)}))};
Y.prototype.hb=function(a){return Wd(new Vd(a,this.da)).then(x(this,function(a){this.l=a;a=kf(new jf(this.M),a,this.j);return Promise.resolve(a)}))};Y.prototype.gb=function(){var a=kf(new jf(this.M),this.l,this.j);return Promise.resolve(a)};function Z(a,b,c){b||(b=new bb);c||(c=new W);X.call(this,null,b,c,null,"");this.R=a;this.M=[];this.timeoutMs=3E4;this.l={};this.j=this.ga=null}q(Z,X);p("shaka.player.OfflineVideoSource",Z);Z.prototype.T=function(a){null!=a.licenseRequestTimeout&&(this.l.licenseRequestTimeout=a.licenseRequestTimeout);null!=a.segmentRequestTimeout&&(this.l.segmentRequestTimeout=a.segmentRequestTimeout);X.prototype.T.call(this,a)};
p("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new Xa,b=Pa(a).then(function(){return Ya(a)});b.then(function(){Ra(a)}).catch(function(){Ra(a)});return b});
Z.prototype.Ba=function(a,b,c,d){var e,f=null,g={},h=[];a=new H(this.ga,[new K(a)]);return Wd(new Vd(a,this.da)).then(x(this,function(a){this.a=kf(new jf(c),a,this.ga);if(this.a.b)return a=Error("Unable to store live streams offline."),a.type="app",Promise.reject(a);this.T({preferredLanguage:b});return X.prototype.X.call(this)})).then(x(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.g);e=new Xe(null,a,this);null!=this.l.licenseRequestTimeout&&(e.w=Number(this.l.licenseRequestTimeout));
B(this.i,e,"sessionReady",this.ta.bind(this));B(this.i,e,"error",function(a){f=a});return e.initialize()})).then(x(this,function(){for(var a=sa(this.b),b=0;b<a.length;++b)for(var c=a[b],e=0;e<c.m.length;++e){var f=c.m[e];g[f.C]=f}return d()})).then(x(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=g[c];if(d)h.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];h=h.filter(function(a){return 0>e.indexOf(a.a.split("/")[0])?!1:!0});a=h.map(function(a){return a.D.create()});
return Promise.all(a)})).then(x(this,function(a){for(var b=h,c=[],d=0;d<b.length;++d)try{c[d]=this.g.addSourceBuffer(xe(b[d]))}catch(e){}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(x(this,function(){return $e(e,this.timeoutMs)})).then(x(this,function(){return f?Promise.reject(f):kg(this,h,e.a,this.a.a[0].b)})).then(x(this,function(a){this.R=a;return f?
(lg(this),Promise.reject(f)):Promise.resolve(a)}))};p("shaka.player.OfflineVideoSource.prototype.store",Z.prototype.Ba);Z.prototype.xa=function(a){this.ga=a};Z.prototype.setNetworkCallback=Z.prototype.xa;Z.prototype.ta=function(a){this.M.push(a.detail.sessionId)};
function kg(a,b,c,d){var e=new Ee(a.Z,a);null!=a.l.segmentRequestTimeout&&(e.b=Number(a.l.segmentRequestTimeout));return Pa(e).then(x(a,function(){return Fe(e,b,this.M,d,c)})).then(function(a){Ra(e);return Promise.resolve(a)}).catch(function(a){Ra(e);return Promise.reject(a)})}
Z.prototype.X=function(){var a=new Xa,b,c;return Pa(a).then(x(this,function(){return Za(a,this.R)})).then(x(this,function(d){var e=[];this.M=d.session_ids;b=d.duration;c={keySystem:d.key_system,distinctiveIdentifierRequired:d.distinctive_identifier,persistentStorageRequired:!0,audioRobustness:d.audio_robustness,videoRobustness:d.video_robustness,withCredentials:d.with_credentials,licenseServerUrl:d.license_server};for(var f=0;f<d.stream_ids.length;++f)e.push($a(a,d.stream_ids[f]));return Promise.all(e)})).then(x(this,
function(a){var e=b,f=c,g=new De;g.c=5;for(var h=new Ce,l=0;l<a.length;++l){var m=a[l],n=new ve,t=new gf(m.references),C=new Zd(null,m.init_segment);n.H=t;n.D=C;n.a=m.mime_type;n.b=m.codecs;n.N=!0;this.j&&(null!=this.j.licenseServerUrl&&(f.licenseServerUrl=this.j.licenseServerUrl),null!=this.j.withCredentials&&(f.withCredentials=this.j.withCredentials),f.licensePostProcessor=this.j.licensePostProcessor,f.licensePreProcessor=this.j.licensePreProcessor,f.serverCertificate=this.j.serverCertificate);
m=Rb(f);t=new ye;t.m.push(n);t.a.push(m);t.contentType=n.a.split("/")[0];h.a.push(t);h.b=e}g.a.push(h);this.a=g;return X.prototype.X.call(this)})).then(function(){Ra(a);return Promise.resolve()}).catch(function(b){Ra(a);return Promise.reject(b)})};
Z.prototype.Aa=function(a,b){a&&(this.j={licenseServerUrl:a.licenseServerUrl,withCredentials:a.withCredentials,serverCertificate:a.serverCertificate,licensePreProcessor:a.licensePreProcessor,licensePostProcessor:a.licensePostProcessor});var c=null;return mg(this).catch(function(a){return b?(c=a,Promise.resolve()):Promise.reject(a)}).then(x(this,function(){return lg(this)})).then(function(){return Promise.resolve(c)})};Z.prototype.deleteGroup=Z.prototype.Aa;Z.prototype.ua=function(){return this.M};
Z.prototype.ha=function(){return!0};function lg(a){var b=new Ee(null,null);return Pa(b).then(x(a,function(){return Ie(b,this.R)})).then(function(){Ra(b);return Promise.resolve()}).catch(function(a){Ra(b);return Promise.reject(a)})}
function mg(a){var b=document.createElement("video");b.src=window.URL.createObjectURL(a.g);var c=new Xe(null,b,a);null!=a.l.licenseRequestTimeout&&(c.w=Number(a.l.licenseRequestTimeout));return a.X().then(function(){return c.initialize()}).then(x(a,function(){return $e(c,this.timeoutMs)})).then(function(){return af(c)}).then(x(a,function(){c.destroy();this.destroy();return Promise.resolve()})).catch(x(a,function(a){c.destroy();this.destroy();return Promise.reject(a)}))};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

